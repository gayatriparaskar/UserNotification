import{r as p,a as Kt,b as Jt}from"./vendor-b69f2a9f.js";import{u as Qt,L as k,N as Xt,a as Zt,b as bt,c as X,B as es,R as ts,d as B}from"./router-bba42d13.js";import{z as v,B as D,X as Z,L as ss,A as Pe,I as rs,C as G,S as Te,a as Nt,H as je,b as le,D as We,U as Ve,M as ns,c as is,T as as,d as Re,R as os,W as He,e as jt,f as it,g as be,h as ze,i as Ye,G as ls,E as K,F as cs,j as J,k as Oe,l as ds,m as hs,P as Ie,n as us,o as ms,p as ps,q as Ne,r as oe,s as xs,t as fs,u as ke,v as gs,w as ys,x as bs,y as Ns,J as vt,K as Le,N as js,O as vs,Q as at,V as ws,Y as Ss,Z as ks,_ as Cs,$ as As,a0 as _s}from"./ui-a21147c2.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();var wt={exports:{}},ve={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Es=p,Ps=Symbol.for("react.element"),Ts=Symbol.for("react.fragment"),Rs=Object.prototype.hasOwnProperty,Os=Es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Is={key:!0,ref:!0,__self:!0,__source:!0};function St(r,t,s){var n,i={},a=null,o=null;s!==void 0&&(a=""+s),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)Rs.call(t,n)&&!Is.hasOwnProperty(n)&&(i[n]=t[n]);if(r&&r.defaultProps)for(n in t=r.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:Ps,type:r,key:a,ref:o,props:i,_owner:Os.current}}ve.Fragment=Ts;ve.jsx=St;ve.jsxs=St;wt.exports=ve;var e=wt.exports,qe={},ot=Kt;qe.createRoot=ot.createRoot,qe.hydrateRoot=ot.hydrateRoot;const kt=p.createContext(),Ls=(r,t)=>{switch(t.type){case"ADD_TO_CART":return r.items.find(n=>n.id===t.payload.id)?{...r,items:r.items.map(n=>n.id===t.payload.id?{...n,quantity:n.quantity+1}:n)}:{...r,items:[...r.items,{...t.payload,quantity:1}]};case"REMOVE_FROM_CART":return{...r,items:r.items.filter(n=>n.id!==t.payload)};case"UPDATE_QUANTITY":return{...r,items:r.items.map(n=>n.id===t.payload.id?{...n,quantity:t.payload.quantity}:n).filter(n=>n.quantity>0)};case"CLEAR_CART":return{...r,items:[]};case"LOAD_CART":return{...r,items:t.payload||[]};default:return r}},qs=({children:r})=>{const[t,s]=p.useReducer(Ls,{items:[]});p.useEffect(()=>{const l=localStorage.getItem("snakeCart");l&&s({type:"LOAD_CART",payload:JSON.parse(l)})},[]),p.useEffect(()=>{localStorage.setItem("snakeCart",JSON.stringify(t.items))},[t.items]);const n=l=>{s({type:"ADD_TO_CART",payload:l}),v.success(`${l.name} added to cart!`)},i=l=>{s({type:"REMOVE_FROM_CART",payload:l}),v.success("Item removed from cart")},a=(l,d)=>{d<=0?i(l):s({type:"UPDATE_QUANTITY",payload:{id:l,quantity:d}})},o=()=>{s({type:"CLEAR_CART"}),v.success("Cart cleared")},c=()=>t.items.reduce((l,d)=>l+d.price*d.quantity,0),h=()=>t.items.reduce((l,d)=>l+d.quantity,0),u={items:t.items,addToCart:n,removeFromCart:i,updateQuantity:a,clearCart:o,getTotalPrice:c,getTotalItems:h};return e.jsx(kt.Provider,{value:u,children:r})},ce=()=>{const r=p.useContext(kt);if(!r)throw new Error("useCart must be used within a CartProvider");return r},Bs={}.VITE_API_URL||"https://notificationbackend-35f6.onrender.com/api";class Ds{constructor(){this.baseURL=Bs}getAuthToken(){return localStorage.getItem("snakeAuthToken")}getHeaders(t=!0){const s={"Content-Type":"application/json"};return t&&this.getAuthToken()&&(s.Authorization=`Bearer ${this.getAuthToken()}`),s}async request(t,s={}){const n=`${this.baseURL}${t}`,i={headers:this.getHeaders(s.includeAuth!==!1),...s},a=new AbortController,o=setTimeout(()=>a.abort(),1e4);i.signal=a.signal;try{const c=await fetch(n,i);clearTimeout(o);let h;const u=c.headers.get("content-type");if(u&&u.includes("application/json")?h=await c.json():h={message:`HTTP error! status: ${c.status}`},!c.ok)throw new Error(h.message||`HTTP error! status: ${c.status}`);return h}catch(c){throw clearTimeout(o),c.name==="AbortError"?new Error("Request timeout - server is not responding"):c.message.includes("ERR_INSUFFICIENT_RESOURCES")?new Error("Server is overloaded or unavailable"):c.message.includes("Failed to fetch")?new Error("Network error - please check your connection"):(console.error(`API request failed for ${t}:`,c),c)}}async login(t,s){const n=await this.request("/auth/login",{method:"POST",body:JSON.stringify({email:t,password:s}),includeAuth:!1});return n.success&&n.data.token&&(localStorage.setItem("snakeAuthToken",n.data.token),localStorage.setItem("snakeUser",JSON.stringify(n.data.user))),n}async register(t){const s=await this.request("/auth/register",{method:"POST",body:JSON.stringify(t),includeAuth:!1});return s.success&&s.data.token&&(localStorage.setItem("snakeAuthToken",s.data.token),localStorage.setItem("snakeUser",JSON.stringify(s.data.user))),s}async logout(){localStorage.removeItem("snakeAuthToken"),localStorage.removeItem("snakeUser")}async getProducts(t={}){const s=new URLSearchParams;Object.keys(t).forEach(i=>{t[i]!==void 0&&t[i]!==null&&t[i]!==""&&s.append(i,t[i])});const n=`/products${s.toString()?`?${s.toString()}`:""}`;return this.request(n)}async getProduct(t){return this.request(`/products/${t}`)}async getProductCategories(){return this.request("/products/categories")}async getProductSpecies(){return this.request("/products/species")}async getOrders(t={}){const s=new URLSearchParams;Object.keys(t).forEach(i=>{t[i]!==void 0&&t[i]!==null&&t[i]!==""&&s.append(i,t[i])});const n=`/orders${s.toString()?`?${s.toString()}`:""}`;return this.request(n)}async getOrder(t){return this.request(`/orders/${t}`)}async createOrder(t){const s=Date.now()+Math.random();return console.log(`🛒 API: createOrder called (ID: ${s}) with data:`,t),this.request("/orders",{method:"POST",body:JSON.stringify(t)})}async updateOrderStatus(t,s,n,i){return this.request(`/orders/${t}/status`,{method:"PUT",body:JSON.stringify({status:s,trackingNumber:n,notes:i})})}async cancelOrder(t,s){return this.request(`/orders/${t}/cancel`,{method:"POST",body:JSON.stringify({reason:s})})}async getUsers(t={}){const s=new URLSearchParams;Object.keys(t).forEach(i=>{t[i]!==void 0&&t[i]!==null&&t[i]!==""&&s.append(i,t[i])});const n=`/users${s.toString()?`?${s.toString()}`:""}`;return this.request(n)}async getUser(t){return this.request(`/users/${t}`)}async updateUser(t,s){return this.request(`/users/${t}`,{method:"PUT",body:JSON.stringify(s)})}async deleteUser(t){return this.request(`/users/${t}`,{method:"DELETE"})}async createProduct(t){return this.request("/products",{method:"POST",body:JSON.stringify(t)})}async updateProduct(t,s){return this.request(`/products/${t}`,{method:"PUT",body:JSON.stringify(s)})}async deleteProduct(t){return this.request(`/products/${t}`,{method:"DELETE"})}async getNotifications(t={}){const s=new URLSearchParams;Object.keys(t).forEach(i=>{t[i]!==void 0&&t[i]!==null&&t[i]!==""&&s.append(i,t[i])});const n=`/notifications${s.toString()?`?${s.toString()}`:""}`;return this.request(n)}async markNotificationAsRead(t){return this.request(`/notifications/${t}/read`,{method:"PUT"})}async markAllNotificationsAsRead(){return this.request("/notifications/read-all",{method:"PUT"})}async getUnreadCount(){return this.request("/notifications/unread-count")}async getProfile(){return this.request("/users/profile")}async updateProfile(t){return this.request("/users/profile",{method:"PUT",body:JSON.stringify(t)})}async changePassword(t){return this.request("/users/change-password",{method:"PUT",body:JSON.stringify(t)})}}const O=new Ds,Ct=p.createContext(),Us=(r,t)=>{switch(t.type){case"LOGIN":return{...r,user:t.payload,isAuthenticated:!0,loading:!1};case"LOGOUT":return{...r,user:null,isAuthenticated:!1,loading:!1};case"LOAD_USER":return{...r,user:t.payload,isAuthenticated:!!t.payload,loading:!1};case"SET_LOADING":return{...r,loading:t.payload};case"SET_ERROR":return{...r,error:t.payload,loading:!1};default:return r}},Fs=({children:r})=>{var c;const[t,s]=p.useReducer(Us,{user:null,isAuthenticated:!1,loading:!1,error:null});p.useEffect(()=>{const h=localStorage.getItem("snakeUser"),u=localStorage.getItem("snakeAuthToken");h&&u&&s({type:"LOAD_USER",payload:JSON.parse(h)})},[]);const n=async(h,u)=>{try{s({type:"SET_LOADING",payload:!0});const l=await O.login(h,u);return l.success?(s({type:"LOGIN",payload:l.data.user}),v.success("Login successful!"),!0):(s({type:"SET_ERROR",payload:l.message}),v.error(l.message||"Login failed"),!1)}catch(l){return s({type:"SET_ERROR",payload:l.message}),v.error(l.message||"Login failed"),!1}},i=async(h,u,l)=>{try{s({type:"SET_LOADING",payload:!0});const d=await O.register({name:h,email:u,password:l});return d.success?(s({type:"LOGIN",payload:d.data.user}),v.success("Registration successful!"),!0):(s({type:"SET_ERROR",payload:d.message}),v.error(d.message||"Registration failed"),!1)}catch(d){return s({type:"SET_ERROR",payload:d.message}),v.error(d.message||"Registration failed"),!1}},a=()=>{O.logout(),s({type:"LOGOUT"}),v.success("Logged out successfully")},o={user:t.user,isAuthenticated:t.isAuthenticated,isAdmin:((c=t.user)==null?void 0:c.role)==="admin",loading:t.loading,error:t.error,login:n,register:i,logout:a};return e.jsx(Ct.Provider,{value:o,children:r})},L=()=>{const r=p.useContext(Ct);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r},At=p.createContext(),$s=(r,t)=>{switch(t.type){case"SET_LOADING":return{...r,loading:t.payload};case"SET_PRODUCTS":return{...r,products:t.payload,loading:!1,error:null};case"SET_FILTER":return{...r,currentFilter:t.payload,loading:!0};case"SET_SEARCH":return{...r,searchQuery:t.payload,loading:!0};case"SET_CATEGORY":return{...r,currentCategory:t.payload,loading:!0};case"SET_ERROR":return{...r,error:t.payload,loading:!1};case"SET_PAGINATION":return{...r,pagination:t.payload};default:return r}},Ms=({children:r})=>{const[t,s]=p.useReducer($s,{products:[],loading:!1,error:null,currentFilter:"all",currentCategory:"all",searchQuery:"",pagination:null}),n=p.useCallback(async(l={})=>{try{s({type:"SET_LOADING",payload:!0});const d=await O.getProducts(l);if(d.success){const x=(d.data.products||[]).map(m=>({...m,quantity:m.quantity!==void 0?m.quantity:10,stock:m.quantity!==void 0?m.quantity:10}));s({type:"SET_PRODUCTS",payload:x}),s({type:"SET_PAGINATION",payload:d.data.pagination})}else s({type:"SET_ERROR",payload:d.message})}catch(d){console.error("Error loading products:",d),s({type:"SET_PRODUCTS",payload:[]}),s({type:"SET_ERROR",payload:null})}},[]);p.useEffect(()=>{const l={};t.searchQuery&&(l.search=t.searchQuery),t.currentCategory!=="all"&&(l.category=t.currentCategory),t.currentFilter!=="all"&&(l.difficulty=t.currentFilter),n(l)},[t.searchQuery,t.currentCategory,t.currentFilter,n]);const i=l=>{s({type:"SET_FILTER",payload:l})},a=l=>{s({type:"SET_SEARCH",payload:l})},o=l=>{s({type:"SET_CATEGORY",payload:l})},c=async l=>{try{const d=await O.getProduct(l);return d.success?d.data.product:null}catch(d){return console.error("Error fetching product:",d),null}},h=p.useCallback(async()=>{try{const l=await O.getProductCategories();return l.success&&l.data.categories?l.data.categories.map(d=>({name:d,displayName:d.charAt(0).toUpperCase()+d.slice(1),count:0})):[]}catch(l){return console.error("Error fetching categories:",l),[{name:"pythons",displayName:"Pythons",count:0},{name:"boas",displayName:"Boas",count:0},{name:"colubrids",displayName:"Colubrids",count:0},{name:"accessories",displayName:"Accessories",count:0}]}},[]),u={products:t.products,loading:t.loading,error:t.error,currentFilter:t.currentFilter,currentCategory:t.currentCategory,searchQuery:t.searchQuery,pagination:t.pagination,setFilter:i,setSearch:a,setCategory:o,getProductById:c,getCategories:h,loadProducts:n};return e.jsx(At.Provider,{value:u,children:r})},Ge=()=>{const r=p.useContext(At);if(!r)throw new Error("useProducts must be used within a ProductProvider");return r},lt=()=>{try{console.log("🔔 Playing notification sound..."),console.log("🔔 Window object available:",typeof window<"u"),console.log("🔔 AudioContext available:",typeof(window.AudioContext||window.webkitAudioContext)<"u"),console.log("🔔 User agent:",navigator.userAgent),console.log("🔔 Is mobile:",/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));const r=new(window.AudioContext||window.webkitAudioContext);console.log("🔔 Audio context created, state:",r.state),r.state==="suspended"?(console.log("🔔 Audio context suspended, trying to resume..."),r.resume().then(()=>{console.log("🔔 Audio context resumed successfully"),Ce(r)}).catch(t=>{console.log("🔔 Audio context could not be resumed - user interaction required:",t),Ce(r)})):(console.log("🔔 Audio context ready, playing sound..."),Ce(r))}catch(r){console.log("🔔 Could not play notification sound:",r),console.log("🔔 Error details:",r.message)}},Ce=r=>{try{console.log("🔔 Playing notification sound..."),console.log("🔔 Audio context state:",r.state);const t=r.createOscillator(),s=r.createGain();t.connect(s),s.connect(r.destination),t.frequency.setValueAtTime(800,r.currentTime),t.frequency.setValueAtTime(1e3,r.currentTime+.1),t.frequency.setValueAtTime(600,r.currentTime+.2),s.gain.setValueAtTime(.4,r.currentTime),s.gain.exponentialRampToValueAtTime(.01,r.currentTime+.3),t.start(r.currentTime),t.stop(r.currentTime+.3),console.log("🔔 Notification sound played successfully")}catch(t){console.log("🔔 Could not play sound:",t),console.log("🔔 Sound error details:",t.message)}},_t=p.createContext(),Ws=(r,t)=>{switch(t.type){case"SET_LOADING":return{...r,loading:t.payload};case"SET_NOTIFICATIONS":const s=t.payload.filter(a=>!a.isRead).length;try{s>0?notificationService.setBadgeCount(s):notificationService.clearBadge(),console.log("🔔 Initial app badge set to:",s)}catch(a){console.error("🔔 Error setting initial app badge:",a)}return{...r,notifications:t.payload,unreadCount:s,loading:!1,error:null};case"SET_ERROR":return{...r,error:t.payload,loading:!1};case"ADD_NOTIFICATION":const n=r.unreadCount+1;return console.log("🔔 Adding notification, new unread count:",n),{...r,notifications:[t.payload,...r.notifications],unreadCount:n};case"MARK_AS_READ":const i=Math.max(0,r.unreadCount-1);try{i>0?notificationService.setBadgeCount(i):notificationService.clearBadge(),console.log("🔔 App badge updated to:",i)}catch(a){console.error("🔔 Error updating app badge:",a)}return{...r,notifications:r.notifications.map(a=>a._id===t.payload?{...a,isRead:!0,readAt:new Date}:a),unreadCount:i};case"MARK_ALL_AS_READ":try{notificationService.clearBadge(),console.log("🔔 App badge cleared - all notifications read")}catch(a){console.error("🔔 Error clearing app badge:",a)}return{...r,notifications:r.notifications.map(a=>({...a,isRead:!0,readAt:new Date})),unreadCount:0};case"SET_UNREAD_COUNT":return{...r,unreadCount:t.payload};default:return r}},Et=({children:r})=>{const{isAuthenticated:t}=L(),[s,n]=p.useReducer(Ws,{notifications:[],loading:!1,error:null,unreadCount:0}),i=async(u={})=>{try{n({type:"SET_LOADING",payload:!0}),n({type:"SET_ERROR",payload:null});const l=await O.getNotifications(u);if(l.success){const d=l.data.notifications||[],x=l.data.unreadCount||0;n({type:"SET_NOTIFICATIONS",payload:d}),n({type:"SET_UNREAD_COUNT",payload:x}),x>0&&!localStorage.getItem("notification-sound-played")&&(lt(),localStorage.setItem("notification-sound-played",Date.now().toString()),setTimeout(()=>{localStorage.removeItem("notification-sound-played")},5e3))}else n({type:"SET_ERROR",payload:l.message})}catch(l){console.error("Error loading notifications:",l);let d="Unable to load notifications. Please check your connection.";l.message.includes("timeout")?d="Server is taking too long to respond. Please try again.":l.message.includes("Failed to fetch")?d="Cannot connect to server. Please check your internet connection.":l.message.includes("ERR_INSUFFICIENT_RESOURCES")&&(d="Server is overloaded. Please try again later."),n({type:"SET_ERROR",payload:d})}},a=async u=>{try{n({type:"MARK_AS_READ",payload:u});try{(await O.markNotificationAsRead(u)).success||console.warn("Server update failed, but UI updated locally")}catch(l){console.warn("Server error marking as read, but UI updated locally:",l.message)}}catch(l){console.error("Error marking notification as read:",l)}},o=async()=>{try{if((await O.markAllNotificationsAsRead()).success){n({type:"MARK_ALL_AS_READ"});try{notificationService.clearBadge(),console.log("🔔 App badge cleared - all notifications read")}catch(l){console.error("🔔 Error clearing app badge:",l)}}}catch(u){console.error("Error marking all notifications as read:",u)}},c=u=>{console.log("🔔 Adding new notification:",u.title),console.log("🔔 Notification data:",u),console.log("🔔 Current unread count:",s.unreadCount),console.log("🔔 Notification ID:",u._id||u.id),console.log("🔔 Notification type:",u.type);const l=u._id||u.id;if(s.notifications.some(m=>(m._id||m.id)===l)){console.log("🔔 Notification already exists, skipping:",l);return}console.log("🔔 Dispatching ADD_NOTIFICATION action"),n({type:"ADD_NOTIFICATION",payload:u}),console.log("🔔 Calling playNotificationSound...");try{lt(),console.log("🔔 Sound function called successfully")}catch(m){console.error("🔔 Error calling sound function:",m)}const x=s.unreadCount+1;console.log("🔔 New unread count:",x);try{notificationService.setBadgeCount(x),console.log("🔔 App badge updated to:",x)}catch(m){console.error("🔔 Error updating app badge:",m)}};p.useEffect(()=>{if(t){let u=0;const l=2,d=async()=>{try{await i()}catch{if(u<l){u++;const m=Math.pow(2,u)*2e3;console.log(`Retrying notification load in ${m}ms (attempt ${u}/${l})`),setTimeout(d,m)}else console.log("Max retries reached for notification loading"),n({type:"SET_ERROR",payload:null})}};setTimeout(d,1e3)}},[t]);const h={notifications:s.notifications,loading:s.loading,error:s.error,unreadCount:s.unreadCount,loadNotifications:i,markAsRead:a,markAllAsRead:o,addNotification:c,isOnline:!s.error||!s.error.includes("Unable to load notifications")};return e.jsx(_t.Provider,{value:h,children:r})},de=()=>{const r=p.useContext(_t);if(!r)throw new Error("useNotifications must be used within a NotificationProvider");return r},Vs=Object.freeze(Object.defineProperty({__proto__:null,NotificationProvider:Et,useNotifications:de},Symbol.toStringTag,{value:"Module"})),H=Object.create(null);H.open="0";H.close="1";H.ping="2";H.pong="3";H.message="4";H.upgrade="5";H.noop="6";const xe=Object.create(null);Object.keys(H).forEach(r=>{xe[H[r]]=r});const Be={type:"error",data:"parser error"},Pt=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Tt=typeof ArrayBuffer=="function",Rt=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,Ke=({type:r,data:t},s,n)=>Pt&&t instanceof Blob?s?n(t):ct(t,n):Tt&&(t instanceof ArrayBuffer||Rt(t))?s?n(t):ct(new Blob([t]),n):n(H[r]+(t||"")),ct=(r,t)=>{const s=new FileReader;return s.onload=function(){const n=s.result.split(",")[1];t("b"+(n||""))},s.readAsDataURL(r)};function dt(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let Ae;function Hs(r,t){if(Pt&&r.data instanceof Blob)return r.data.arrayBuffer().then(dt).then(t);if(Tt&&(r.data instanceof ArrayBuffer||Rt(r.data)))return t(dt(r.data));Ke(r,!1,s=>{Ae||(Ae=new TextEncoder),t(Ae.encode(s))})}const ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ae=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<ht.length;r++)ae[ht.charCodeAt(r)]=r;const zs=r=>{let t=r.length*.75,s=r.length,n,i=0,a,o,c,h;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);const u=new ArrayBuffer(t),l=new Uint8Array(u);for(n=0;n<s;n+=4)a=ae[r.charCodeAt(n)],o=ae[r.charCodeAt(n+1)],c=ae[r.charCodeAt(n+2)],h=ae[r.charCodeAt(n+3)],l[i++]=a<<2|o>>4,l[i++]=(o&15)<<4|c>>2,l[i++]=(c&3)<<6|h&63;return u},Ys=typeof ArrayBuffer=="function",Je=(r,t)=>{if(typeof r!="string")return{type:"message",data:Ot(r,t)};const s=r.charAt(0);return s==="b"?{type:"message",data:Gs(r.substring(1),t)}:xe[s]?r.length>1?{type:xe[s],data:r.substring(1)}:{type:xe[s]}:Be},Gs=(r,t)=>{if(Ys){const s=zs(r);return Ot(s,t)}else return{base64:!0,data:r}},Ot=(r,t)=>{switch(t){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},It=String.fromCharCode(30),Ks=(r,t)=>{const s=r.length,n=new Array(s);let i=0;r.forEach((a,o)=>{Ke(a,!1,c=>{n[o]=c,++i===s&&t(n.join(It))})})},Js=(r,t)=>{const s=r.split(It),n=[];for(let i=0;i<s.length;i++){const a=Je(s[i],t);if(n.push(a),a.type==="error")break}return n};function Qs(){return new TransformStream({transform(r,t){Hs(r,s=>{const n=s.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}r.data&&typeof r.data!="string"&&(i[0]|=128),t.enqueue(i),t.enqueue(s)})}})}let _e;function ue(r){return r.reduce((t,s)=>t+s.length,0)}function me(r,t){if(r[0].length===t)return r.shift();const s=new Uint8Array(t);let n=0;for(let i=0;i<t;i++)s[i]=r[0][n++],n===r[0].length&&(r.shift(),n=0);return r.length&&n<r[0].length&&(r[0]=r[0].slice(n)),s}function Xs(r,t){_e||(_e=new TextDecoder);const s=[];let n=0,i=-1,a=!1;return new TransformStream({transform(o,c){for(s.push(o);;){if(n===0){if(ue(s)<1)break;const h=me(s,1);a=(h[0]&128)===128,i=h[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(ue(s)<2)break;const h=me(s,2);i=new DataView(h.buffer,h.byteOffset,h.length).getUint16(0),n=3}else if(n===2){if(ue(s)<8)break;const h=me(s,8),u=new DataView(h.buffer,h.byteOffset,h.length),l=u.getUint32(0);if(l>Math.pow(2,53-32)-1){c.enqueue(Be);break}i=l*Math.pow(2,32)+u.getUint32(4),n=3}else{if(ue(s)<i)break;const h=me(s,i);c.enqueue(Je(a?h:_e.decode(h),t)),n=0}if(i===0||i>r){c.enqueue(Be);break}}}})}const Lt=4;function P(r){if(r)return Zs(r)}function Zs(r){for(var t in P.prototype)r[t]=P.prototype[t];return r}P.prototype.on=P.prototype.addEventListener=function(r,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(t),this};P.prototype.once=function(r,t){function s(){this.off(r,s),t.apply(this,arguments)}return s.fn=t,this.on(r,s),this};P.prototype.off=P.prototype.removeListener=P.prototype.removeAllListeners=P.prototype.removeEventListener=function(r,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+r];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var n,i=0;i<s.length;i++)if(n=s[i],n===t||n.fn===t){s.splice(i,1);break}return s.length===0&&delete this._callbacks["$"+r],this};P.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),s=this._callbacks["$"+r],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(s){s=s.slice(0);for(var n=0,i=s.length;n<i;++n)s[n].apply(this,t)}return this};P.prototype.emitReserved=P.prototype.emit;P.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};P.prototype.hasListeners=function(r){return!!this.listeners(r).length};const we=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,s)=>s(t,0))(),$=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())(),er="arraybuffer";function qt(r,...t){return t.reduce((s,n)=>(r.hasOwnProperty(n)&&(s[n]=r[n]),s),{})}const tr=$.setTimeout,sr=$.clearTimeout;function Se(r,t){t.useNativeTimers?(r.setTimeoutFn=tr.bind($),r.clearTimeoutFn=sr.bind($)):(r.setTimeoutFn=$.setTimeout.bind($),r.clearTimeoutFn=$.clearTimeout.bind($))}const rr=1.33;function nr(r){return typeof r=="string"?ir(r):Math.ceil((r.byteLength||r.size)*rr)}function ir(r){let t=0,s=0;for(let n=0,i=r.length;n<i;n++)t=r.charCodeAt(n),t<128?s+=1:t<2048?s+=2:t<55296||t>=57344?s+=3:(n++,s+=4);return s}function Bt(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ar(r){let t="";for(let s in r)r.hasOwnProperty(s)&&(t.length&&(t+="&"),t+=encodeURIComponent(s)+"="+encodeURIComponent(r[s]));return t}function or(r){let t={},s=r.split("&");for(let n=0,i=s.length;n<i;n++){let a=s[n].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class lr extends Error{constructor(t,s,n){super(t),this.description=s,this.context=n,this.type="TransportError"}}class Qe extends P{constructor(t){super(),this.writable=!1,Se(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,s,n){return super.emitReserved("error",new lr(t,s,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const s=Je(t,this.socket.binaryType);this.onPacket(s)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,s={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const s=ar(t);return s.length?"?"+s:""}}class cr extends Qe{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const s=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||s()})),this.writable||(n++,this.once("drain",function(){--n||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const s=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};Js(t,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Ks(t,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=Bt()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(t,s)}}let Dt=!1;try{Dt=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const dr=Dt;function hr(){}class ur extends cr{constructor(t){if(super(t),typeof location<"u"){const s=location.protocol==="https:";let n=location.port;n||(n=s?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,s){const n=this.request({method:"POST",data:t});n.on("success",s),n.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(s,n)=>{this.onError("xhr poll error",s,n)}),this.pollXhr=t}}class V extends P{constructor(t,s,n){super(),this.createRequest=t,Se(this,n),this._opts=n,this._method=n.method||"GET",this._uri=s,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var t;const s=qt(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(s);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=V.requestsCount++,V.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=hr,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete V.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}V.requestsCount=0;V.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",ut);else if(typeof addEventListener=="function"){const r="onpagehide"in $?"pagehide":"unload";addEventListener(r,ut,!1)}}function ut(){for(let r in V.requests)V.requests.hasOwnProperty(r)&&V.requests[r].abort()}const mr=function(){const r=Ut({xdomain:!1});return r&&r.responseType!==null}();class pr extends ur{constructor(t){super(t);const s=t&&t.forceBase64;this.supportsBinary=mr&&!s}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new V(Ut,this.uri(),t)}}function Ut(r){const t=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||dr))return new XMLHttpRequest}catch{}if(!t)try{return new $[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Ft=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class xr extends Qe{get name(){return"websocket"}doOpen(){const t=this.uri(),s=this.opts.protocols,n=Ft?{}:qt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,s,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let s=0;s<t.length;s++){const n=t[s],i=s===t.length-1;Ke(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}i&&we(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=Bt()),this.supportsBinary||(s.b64=1),this.createUri(t,s)}}const Ee=$.WebSocket||$.MozWebSocket;class fr extends xr{createSocket(t,s,n){return Ft?new Ee(t,s,n):s?new Ee(t,s):new Ee(t)}doWrite(t,s){this.ws.send(s)}}class gr extends Qe{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const s=Xs(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(s).getReader(),i=Qs();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();const a=()=>{n.read().then(({done:c,value:h})=>{c||(this.onPacket(h),a())}).catch(c=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let s=0;s<t.length;s++){const n=t[s],i=s===t.length-1;this._writer.write(n).then(()=>{i&&we(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const yr={websocket:fr,webtransport:gr,polling:pr},br=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Nr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function De(r){if(r.length>8e3)throw"URI too long";const t=r,s=r.indexOf("["),n=r.indexOf("]");s!=-1&&n!=-1&&(r=r.substring(0,s)+r.substring(s,n).replace(/:/g,";")+r.substring(n,r.length));let i=br.exec(r||""),a={},o=14;for(;o--;)a[Nr[o]]=i[o]||"";return s!=-1&&n!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=jr(a,a.path),a.queryKey=vr(a,a.query),a}function jr(r,t){const s=/\/{2,9}/g,n=t.replace(s,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&n.splice(0,1),t.slice(-1)=="/"&&n.splice(n.length-1,1),n}function vr(r,t){const s={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,a){i&&(s[i]=a)}),s}const Ue=typeof addEventListener=="function"&&typeof removeEventListener=="function",fe=[];Ue&&addEventListener("offline",()=>{fe.forEach(r=>r())},!1);class Y extends P{constructor(t,s){if(super(),this.binaryType=er,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(s=t,t=null),t){const n=De(t);s.hostname=n.host,s.secure=n.protocol==="https"||n.protocol==="wss",s.port=n.port,n.query&&(s.query=n.query)}else s.host&&(s.hostname=De(s.host).host);Se(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(n=>{const i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=or(this.opts.query)),Ue&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},fe.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const s=Object.assign({},this.opts.query);s.EIO=Lt,s.transport=t,this.id&&(s.sid=this.id);const n=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Y.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(t);s.open(),this.setTransport(s)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",s=>this._onClose("transport close",s))}onOpen(){this.readyState="open",Y.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=t.data,this._onError(s);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(s+=nr(i)),n>0&&s>this._maxPayload)return this.writeBuffer.slice(0,n);s+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,we(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,s,n){return this._sendPacket("message",t,s,n),this}send(t,s,n){return this._sendPacket("message",t,s,n),this}_sendPacket(t,s,n,i){if(typeof s=="function"&&(i=s,s=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:t,data:s,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),t()},n=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}_onError(t){if(Y.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ue&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=fe.indexOf(this._offlineEventListener);n!==-1&&fe.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,s),this.writeBuffer=[],this._prevBufferLen=0}}}Y.protocol=Lt;class wr extends Y{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let s=this.createTransport(t),n=!1;Y.priorWebsocketSuccess=!1;const i=()=>{n||(s.send([{type:"ping",data:"probe"}]),s.once("packet",d=>{if(!n)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;Y.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(l(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const x=new Error("probe error");x.transport=s.name,this.emitReserved("upgradeError",x)}}))};function a(){n||(n=!0,l(),s.close(),s=null)}const o=d=>{const x=new Error("probe error: "+d);x.transport=s.name,a(),this.emitReserved("upgradeError",x)};function c(){o("transport closed")}function h(){o("socket closed")}function u(d){s&&d.name!==s.name&&a()}const l=()=>{s.removeListener("open",i),s.removeListener("error",o),s.removeListener("close",c),this.off("close",h),this.off("upgrading",u)};s.once("open",i),s.once("error",o),s.once("close",c),this.once("close",h),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{n||s.open()},200):s.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const s=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&s.push(t[n]);return s}}let Sr=class extends wr{constructor(t,s={}){const n=typeof t=="object"?t:s;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>yr[i]).filter(i=>!!i)),super(t,n)}};function kr(r,t="",s){let n=r;s=s||typeof location<"u"&&location,r==null&&(r=s.protocol+"//"+s.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=s.protocol+r:r=s.host+r),/^(https?|wss?):\/\//.test(r)||(typeof s<"u"?r=s.protocol+"//"+r:r="https://"+r),n=De(r)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+t,n.href=n.protocol+"://"+a+(s&&s.port===n.port?"":":"+n.port),n}const Cr=typeof ArrayBuffer=="function",Ar=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,$t=Object.prototype.toString,_r=typeof Blob=="function"||typeof Blob<"u"&&$t.call(Blob)==="[object BlobConstructor]",Er=typeof File=="function"||typeof File<"u"&&$t.call(File)==="[object FileConstructor]";function Xe(r){return Cr&&(r instanceof ArrayBuffer||Ar(r))||_r&&r instanceof Blob||Er&&r instanceof File}function ge(r,t){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let s=0,n=r.length;s<n;s++)if(ge(r[s]))return!0;return!1}if(Xe(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return ge(r.toJSON(),!0);for(const s in r)if(Object.prototype.hasOwnProperty.call(r,s)&&ge(r[s]))return!0;return!1}function Pr(r){const t=[],s=r.data,n=r;return n.data=Fe(s,t),n.attachments=t.length,{packet:n,buffers:t}}function Fe(r,t){if(!r)return r;if(Xe(r)){const s={_placeholder:!0,num:t.length};return t.push(r),s}else if(Array.isArray(r)){const s=new Array(r.length);for(let n=0;n<r.length;n++)s[n]=Fe(r[n],t);return s}else if(typeof r=="object"&&!(r instanceof Date)){const s={};for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=Fe(r[n],t));return s}return r}function Tr(r,t){return r.data=$e(r.data,t),delete r.attachments,r}function $e(r,t){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<t.length)return t[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let s=0;s<r.length;s++)r[s]=$e(r[s],t);else if(typeof r=="object")for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(r[s]=$e(r[s],t));return r}const Rr=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Or=5;var _;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(_||(_={}));class Ir{constructor(t){this.replacer=t}encode(t){return(t.type===_.EVENT||t.type===_.ACK)&&ge(t)?this.encodeAsBinary({type:t.type===_.EVENT?_.BINARY_EVENT:_.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let s=""+t.type;return(t.type===_.BINARY_EVENT||t.type===_.BINARY_ACK)&&(s+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(s+=t.nsp+","),t.id!=null&&(s+=t.id),t.data!=null&&(s+=JSON.stringify(t.data,this.replacer)),s}encodeAsBinary(t){const s=Pr(t),n=this.encodeAsString(s.packet),i=s.buffers;return i.unshift(n),i}}function mt(r){return Object.prototype.toString.call(r)==="[object Object]"}class Ze extends P{constructor(t){super(),this.reviver=t}add(t){let s;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(t);const n=s.type===_.BINARY_EVENT;n||s.type===_.BINARY_ACK?(s.type=n?_.EVENT:_.ACK,this.reconstructor=new Lr(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(Xe(t)||t.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(t),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let s=0;const n={type:Number(t.charAt(0))};if(_[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===_.BINARY_EVENT||n.type===_.BINARY_ACK){const a=s+1;for(;t.charAt(++s)!=="-"&&s!=t.length;);const o=t.substring(a,s);if(o!=Number(o)||t.charAt(s)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(t.charAt(s+1)==="/"){const a=s+1;for(;++s&&!(t.charAt(s)===","||s===t.length););n.nsp=t.substring(a,s)}else n.nsp="/";const i=t.charAt(s+1);if(i!==""&&Number(i)==i){const a=s+1;for(;++s;){const o=t.charAt(s);if(o==null||Number(o)!=o){--s;break}if(s===t.length)break}n.id=Number(t.substring(a,s+1))}if(t.charAt(++s)){const a=this.tryParse(t.substr(s));if(Ze.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,s){switch(t){case _.CONNECT:return mt(s);case _.DISCONNECT:return s===void 0;case _.CONNECT_ERROR:return typeof s=="string"||mt(s);case _.EVENT:case _.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&Rr.indexOf(s[0])===-1);case _.ACK:case _.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Lr{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const s=Tr(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const qr=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Ze,Encoder:Ir,get PacketType(){return _},protocol:Or},Symbol.toStringTag,{value:"Module"}));function M(r,t,s){return r.on(t,s),function(){r.off(t,s)}}const Br=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Mt extends P{constructor(t,s,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=s,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[M(t,"open",this.onopen.bind(this)),M(t,"packet",this.onpacket.bind(this)),M(t,"error",this.onerror.bind(this)),M(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...s){var n,i,a;if(Br.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(s.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const o={type:_.EVENT,data:s};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const l=this.ids++,d=s.pop();this._registerAckCallback(l,d),o.id=l}const c=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,h=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!c||(h?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,s){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[t]=s;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===t&&this.sendBuffer.splice(c,1);s.call(this,new Error("operation has timed out"))},i),o=(...c)=>{this.io.clearTimeoutFn(a),s.apply(this,c)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...s){return new Promise((n,i)=>{const a=(o,c)=>o?i(o):n(c);a.withError=!0,s.push(a),this.emit(t,...s)})}_addToQueue(t){let s;typeof t[t.length-1]=="function"&&(s=t.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...a)=>n!==this._queue[0]?void 0:(i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(i)):(this._queue.shift(),s&&s(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!t||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:_.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(n=>String(n.id)===t)){const n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case _.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case _.EVENT:case _.BINARY_EVENT:this.onevent(t);break;case _.ACK:case _.BINARY_ACK:this.onack(t);break;case _.DISCONNECT:this.ondisconnect();break;case _.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){const s=t.data||[];t.id!=null&&s.push(this.ack(t.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const n of s)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const s=this;let n=!1;return function(...i){n||(n=!0,s.packet({type:_.ACK,id:t,data:i}))}}onack(t){const s=this.acks[t.id];typeof s=="function"&&(delete this.acks[t.id],s.withError&&t.data.unshift(null),s.apply(this,t.data))}onconnect(t,s){this.id=t,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:_.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const s=this._anyListeners;for(let n=0;n<s.length;n++)if(t===s[n])return s.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const s=this._anyOutgoingListeners;for(let n=0;n<s.length;n++)if(t===s[n])return s.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const n of s)n.apply(this,t.data)}}}function ee(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}ee.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),s=Math.floor(t*this.jitter*r);r=Math.floor(t*10)&1?r+s:r-s}return Math.min(r,this.max)|0};ee.prototype.reset=function(){this.attempts=0};ee.prototype.setMin=function(r){this.ms=r};ee.prototype.setMax=function(r){this.max=r};ee.prototype.setJitter=function(r){this.jitter=r};class Me extends P{constructor(t,s){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(s=t,t=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,Se(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((n=s.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new ee({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=t;const i=s.parser||qr;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var s;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(s=this.backoff)===null||s===void 0||s.setMin(t),this)}randomizationFactor(t){var s;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(s=this.backoff)===null||s===void 0||s.setJitter(t),this)}reconnectionDelayMax(t){var s;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(s=this.backoff)===null||s===void 0||s.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Sr(this.uri,this.opts);const s=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=M(s,"open",function(){n.onopen(),t&&t()}),a=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),t?t(c):this.maybeReconnectOnOpen()},o=M(s,"error",a);if(this._timeout!==!1){const c=this._timeout,h=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),s.close()},c);this.opts.autoUnref&&h.unref(),this.subs.push(()=>{this.clearTimeoutFn(h)})}return this.subs.push(i),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(M(t,"ping",this.onping.bind(this)),M(t,"data",this.ondata.bind(this)),M(t,"error",this.onerror.bind(this)),M(t,"close",this.onclose.bind(this)),M(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(s){this.onclose("parse error",s)}}ondecoded(t){we(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,s){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new Mt(this,t,s),this.nsps[t]=n),n}_destroy(t){const s=Object.keys(this.nsps);for(const n of s)if(this.nsps[n].active)return;this._close()}_packet(t){const s=this.encoder.encode(t);for(let n=0;n<s.length;n++)this.engine.write(s[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,s){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},s);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const ie={};function ye(r,t){typeof r=="object"&&(t=r,r=void 0),t=t||{};const s=kr(r,t.path||"/socket.io"),n=s.source,i=s.id,a=s.path,o=ie[i]&&a in ie[i].nsps,c=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let h;return c?h=new Me(n,t):(ie[i]||(ie[i]=new Me(n,t)),h=ie[i]),s.query&&!t.query&&(t.query=s.queryKey),h.socket(s.path,t)}Object.assign(ye,{Manager:Me,Socket:Mt,io:ye,connect:ye});const Wt=p.createContext();let pt=0;const Dr=({children:r})=>{const[t,s]=p.useState(null),[n,i]=p.useState(!1);p.useEffect(()=>{const m=({}.VITE_API_URL||"https://notificationbackend-35f6.onrender.com/api").replace("/api","");pt++,console.log(`🔌 Connecting to socket (attempt #${pt}):`,m);const b=ye(m,{transports:["polling","websocket"],autoConnect:!0,reconnection:!0,reconnectionAttempts:15,reconnectionDelay:1e3,reconnectionDelayMax:15e3,timeout:2e4,forceNew:!0,upgrade:!0,rememberUpgrade:!1,pingTimeout:6e4,pingInterval:25e3});return b.on("connect",()=>{console.log("🔌 Socket connected successfully"),console.log("🔌 Socket URL:",m),console.log("🔌 Socket ID:",b.id),console.log("🔌 Transport:",b.io.engine.transport.name),console.log("🔌 User agent:",navigator.userAgent),console.log("🔌 Is mobile:",/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)),console.log("🔌 Connection time:",new Date().toISOString()),console.log("🔌 Socket instance:",b),i(!0)}),b.on("disconnect",f=>{console.log("🔌 Socket disconnected:",f),i(!1)}),b.on("connect_error",f=>{console.error("🔌 Socket connection error:",f),console.error("🔌 Socket URL attempted:",m),console.error("🔌 Error details:",f.message),i(!1)}),b.on("reconnect",f=>{console.log("🔌 Socket reconnected after",f,"attempts"),i(!0)}),b.on("reconnect_error",f=>{console.error("🔌 Socket reconnection error:",f)}),b.on("reconnect_failed",()=>{console.error("🔌 Socket reconnection failed"),i(!1)}),s(b),()=>{b.close()}},[]);const d={socket:t,isConnected:n,joinUserRoom:x=>{t&&x&&t.emit("join-user-room",x)},leaveUserRoom:x=>{t&&x&&t.emit("leave-user-room",x)},onNotification:x=>{t&&(t.on("notification",x),t.on("new-notification",x))},offNotification:x=>{t&&(t.off("notification",x),t.off("new-notification",x))},onOrderUpdate:x=>{t&&t.on("order-update",x)},offOrderUpdate:x=>{t&&t.off("order-update",x)}};return e.jsx(Wt.Provider,{value:d,children:r})},et=()=>{const r=p.useContext(Wt);if(!r)throw new Error("useSocket must be used within a SocketProvider");return r};class Ur{constructor(){this.isSupported=typeof window<"u"&&"Notification"in window,this.permission=this.isSupported?Notification.permission:"denied",this.registration=null}async requestPermission(){if(!this.isSupported||typeof window>"u")return console.log("Notifications are not supported in this browser"),!1;if(Notification.permission==="granted")return console.log("Notification enabled"),this.permission="granted",!0;if(Notification.permission==="denied")return console.log("Notification blocked"),this.permission="denied",!1;try{console.log("Requesting notification permission..."),console.log("Current permission:",this.permission),console.log("User agent:",navigator.userAgent);const t=await Notification.requestPermission();return this.permission=t,console.log("Notification permission result:",t),t==="granted"?(console.log("Notification permission granted successfully"),!0):(console.log("Notification permission denied or dismissed"),!1)}catch(t){return console.error("Error requesting notification permission:",t),!1}}async subscribeToPush(){if(!this.isSupported||this.permission!=="granted"||typeof window>"u")return console.log("Notifications not supported or permission not granted"),null;try{this.registration=await navigator.serviceWorker.ready;const t=await this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array("BEl62iUYgUivxIkv69yViEuiBIa40HI8F7V7jz0swbINB6FUrr7g8cWf3u8u3BqH7yQf4QvY4nF3U8X9Y2Z1A=")});return console.log("Push subscription successful:",t),t}catch(t){return console.error("Error subscribing to push notifications:",t),null}}async unsubscribeFromPush(){if(!this.registration)return console.log("No active registration found"),!1;try{const t=await this.registration.pushManager.getSubscription();return t?(await t.unsubscribe(),console.log("Successfully unsubscribed from push notifications"),!0):!1}catch(t){return console.error("Error unsubscribing from push notifications:",t),!1}}async showNotification(t,s={}){if(!this.isSupported||this.permission!=="granted"||typeof window>"u")return console.log("Cannot show notification - not supported or permission denied"),!1;try{const n=new Notification(t,{icon:"/icons/icon-192x192.png",badge:"/icons/icon-72x72.png",vibrate:[200,100,200],requireInteraction:!0,...s});return n.onclick=()=>{window.focus(),n.close()},!0}catch(n){return console.error("Error showing notification:",n),!1}}isPushSupported(){return this.isSupported&&typeof window<"u"&&"serviceWorker"in navigator&&"PushManager"in window}setBadgeCount(t){if(typeof window<"u"&&"setAppBadge"in navigator)try{t>0?(navigator.setAppBadge(t),console.log("App badge set to:",t)):(navigator.clearAppBadge(),console.log("App badge cleared"))}catch(s){console.error("Error setting app badge:",s)}else console.log("App badge API not supported")}clearBadge(){if(typeof window<"u"&&"clearAppBadge"in navigator)try{navigator.clearAppBadge(),console.log("App badge cleared")}catch(t){console.error("Error clearing app badge:",t)}}async getSubscription(){if(typeof window>"u"||!this.registration)if(typeof window<"u")this.registration=await navigator.serviceWorker.ready;else return null;return await this.registration.pushManager.getSubscription()}urlBase64ToUint8Array(t){const s="=".repeat((4-t.length%4)%4),n=(t+s).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(n),a=new Uint8Array(i.length);for(let o=0;o<i.length;++o)a[o]=i.charCodeAt(o);return a}async testNotification(){return await this.showNotification("SnacksShop Test",{body:"This is a test notification from SnacksShop!",tag:"test-notification"})}getPermissionStatus(){return this.isSupported?{status:this.permission,canShow:this.permission==="granted"}:{status:"denied",canShow:!1}}}const I=new Ur;let pe=!1;const Fr=()=>{const{user:r,isAuthenticated:t}=L(),{addNotification:s,loadNotifications:n}=de(),{socket:i,isConnected:a,joinUserRoom:o,leaveUserRoom:c,onNotification:h,offNotification:u}=et(),l=new Set;return p.useEffect(()=>{if(!t||!r||!i){console.log("🔔 Not setting up notifications - missing requirements:",{isAuthenticated:t,hasUser:!!r,hasSocket:!!i});return}const d=r._id||r.id;if(!d){console.log("🔔 User ID not found in user object:",r);return}console.log("🔔 Setting up real-time notifications for user:",d),console.log("🔔 Socket object:",i),console.log("🔔 Socket connected:",i.connected),console.log("🔔 Socket ID:",i.id),console.log("🔔 User role:",r.role),console.log("🔔 Is admin:",r.role==="admin"),console.log("🔔 User agent:",navigator.userAgent),console.log("🔔 Is mobile:",/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)),console.log("🔔 Notification permission:",Notification.permission),i.connected?(console.log("🔔 Socket already connected, joining user room"),o(d)):(console.log("🔔 Socket not connected, waiting for connection..."),i.on("connect",()=>{console.log("🔔 Socket connected, joining user room"),o(d)}));const x=m=>{var C;if(console.log("🔔 Received real-time notification:",m),console.log("🔔 Data type:",typeof m),console.log("🔔 Data keys:",Object.keys(m||{})),console.log("🔔 Socket connected:",i.connected),console.log("🔔 Socket ID:",i.id),pe){console.log("🔔 Notification already being processed globally, skipping");return}const b=m.notification||m;if(!b){console.log("🔔 No notification found in data");return}const f=b._id||b.id;if(f&&l.has(f)){console.log("🔔 Notification already processed, skipping:",f);return}pe=!0,setTimeout(()=>{pe=!1},5e3),f&&l.add(f),console.log("🔔 Processing notification:",b.title),s(b),I.getPermissionStatus&&I.getPermissionStatus().canShow?(console.log("🔔 Showing browser notification"),I.showNotification(b.title,{body:b.message,tag:`notification-${b._id}`,data:{url:((C=b.data)==null?void 0:C.url)||"/",notificationId:b._id}})):console.log("🔔 Browser notifications not available"),v.success(b.title,{duration:4e3,position:"top-right"}),console.log("🔔 Notification processed successfully"),pe=!1};return i&&i.connected&&r&&r._id&&(console.log("🔔 Joining user room for user:",r._id),i.emit("join-user-room",r._id)),console.log("🔔 Setting up socket event listeners..."),console.log("🔔 Socket connected for notifications:",i.connected),console.log("🔔 Socket ID for notifications:",i.id),i.on("new-notification",m=>{console.log("🔔 Received new-notification event:",m),console.log("🔔 Notification data type:",typeof m),console.log("🔔 Notification data keys:",Object.keys(m||{})),console.log("🔔 Socket connected when receiving:",i.connected),console.log("🔔 Socket ID when receiving:",i.id),console.log("🔔 User agent when receiving:",navigator.userAgent),console.log("🔔 Is mobile when receiving:",/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)),console.log("🔔 Timestamp when receiving:",new Date().toISOString()),x(m)}),i.onAny((m,...b)=>{m!=="new-notification"&&console.log("🔔 Socket event received:",m,b)}),()=>{i.off("new-notification",x),c(d)}},[t,r,i,a]),p.useEffect(()=>{(async()=>{if(t)try{if(await(I.requestPermission?I.requestPermission():Promise.resolve(!1))){console.log("🔔 Notification permission granted");const m=await(I.subscribeToPush?I.subscribeToPush():Promise.resolve(!1));console.log(m?"🔔 Web push subscription successful":"🔔 Web push subscription failed or not supported")}else console.log("🔔 Notification permission denied")}catch(x){console.error("🔔 Error setting up notifications:",x)}})()},[t]),p.useEffect(()=>{if(t&&r){const d=setTimeout(()=>{n()},2e3);return()=>clearTimeout(d)}},[t,r]),{isConnected:a,permissionStatus:I.getPermissionStatus?I.getPermissionStatus():{status:"denied",canShow:!1}}},$r=()=>{const[r,t]=p.useState(!1),[s,n]=p.useState(!1),[i,a]=p.useState(null),[o,c]=p.useState("desktop");return p.useEffect(()=>{(()=>{const f=navigator.userAgent;/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(f)?/iPad|Android.*Tablet/i.test(f)?c("tablet"):c("mobile"):c("desktop")})();const d=()=>{const f=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;n(f)};d();const x=f=>{f.preventDefault(),a(f),t(!0)},m=()=>{n(!0),t(!1),a(null)};window.addEventListener("beforeinstallprompt",x),window.addEventListener("appinstalled",m);const b=setInterval(d,1e3);return()=>{window.removeEventListener("beforeinstallprompt",x),window.removeEventListener("appinstalled",m),clearInterval(b)}},[]),{isInstallable:r,isInstalled:s,deviceType:o,install:async()=>{if(!i)return!1;i.prompt();const{outcome:l}=await i.userChoice;return l==="accepted"?(console.log("User accepted the install prompt"),!0):(console.log("User dismissed the install prompt"),!1)},getInstallInstructions:()=>{switch(o){case"mobile":return{title:"Install SnacksShop App",steps:["Tap the share button in your browser","Select 'Add to Home Screen'","Tap 'Add' to install the app"]};case"tablet":return{title:"Install SnacksShop App",steps:["Tap the menu button (⋮) in your browser","Select 'Add to Home Screen'","Tap 'Add' to install the app"]};default:return{title:"Install SnacksShop App",steps:["Click the install button below","Or look for the install icon in your browser's address bar","Click 'Install' when prompted"]}}}}},Mr=({isOpen:r,onClose:t})=>{const{notifications:s,unreadCount:n,markAsRead:i,markAllAsRead:a,loadNotifications:o}=de(),{isAuthenticated:c}=L(),[h,u]=p.useState("all"),[l,d]=p.useState(null);p.useEffect(()=>{r&&c&&o()},[r,c,o]);const x=w=>{switch(w){case"order_placed":return e.jsx(G,{className:"h-5 w-5 text-green-500"});case"order_confirmed":return e.jsx(G,{className:"h-5 w-5 text-blue-500"});case"order_shipped":return e.jsx(G,{className:"h-5 w-5 text-purple-500"});case"order_delivered":return e.jsx(G,{className:"h-5 w-5 text-green-500"});case"order_cancelled":return e.jsx(Pe,{className:"h-5 w-5 text-red-500"});case"product_added":return e.jsx(rs,{className:"h-5 w-5 text-blue-500"});case"stock_low":return e.jsx(Pe,{className:"h-5 w-5 text-yellow-500"});default:return e.jsx(D,{className:"h-5 w-5 text-gray-500"})}},m=w=>{switch(w){case"order_placed":return"bg-green-50 border-green-200";case"order_confirmed":return"bg-blue-50 border-blue-200";case"order_shipped":return"bg-purple-50 border-purple-200";case"order_delivered":return"bg-green-50 border-green-200";case"order_cancelled":return"bg-red-50 border-red-200";case"product_added":return"bg-blue-50 border-blue-200";case"stock_low":return"bg-yellow-50 border-yellow-200";default:return"bg-gray-50 border-gray-200"}},b=w=>{const N=new Date(w),E=Math.floor((new Date-N)/(1e3*60));return E<1?"Just now":E<60?`${E}m ago`:E<1440?`${Math.floor(E/60)}h ago`:N.toLocaleDateString()},f=async w=>{try{d(w),await i(w),v.success("✅ Notification marked as read",{duration:2e3,style:{background:"#10B981",color:"#fff"}})}catch{v.error("Failed to mark notification as read")}finally{d(null)}},C=async()=>{try{await a(),v.success("✅ All notifications marked as read",{duration:2e3,style:{background:"#10B981",color:"#fff"}})}catch{v.error("Failed to mark all notifications as read")}},S=s.filter(w=>{var N;return h==="unread"?!w.isRead:h==="orders"?(N=w.type)==null?void 0:N.includes("order"):!0});return r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(D,{className:"h-6 w-6 text-primary-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Notifications"}),n>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-1",children:n})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(Z,{className:"h-5 w-5 text-gray-500"})})]}),e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>u("all"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${h==="all"?"bg-primary-100 text-primary-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"All"}),e.jsx("button",{onClick:()=>u("unread"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${h==="unread"?"bg-primary-100 text-primary-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Unread"}),e.jsx("button",{onClick:()=>u("orders"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${h==="orders"?"bg-primary-100 text-primary-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Orders"})]})}),n>0&&e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx("button",{onClick:C,className:"text-sm text-primary-600 hover:text-primary-800 font-medium",children:"Mark all as read"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:S.length>0?e.jsx("div",{className:"p-4 space-y-3",children:S.map(w=>{var N;return e.jsx("div",{className:`p-4 rounded-lg border transition-all duration-300 ${w.isRead?"bg-white border-gray-200 opacity-75":`${m(w.type)} border-l-4 shadow-sm`}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:x(w.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`text-sm font-medium ${w.isRead?"text-gray-700":"text-gray-900"}`,children:w.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:b(w.createdAt)}),!w.isRead&&e.jsx("button",{onClick:()=>f(w._id),disabled:l===w._id,className:"text-xs text-primary-600 hover:text-primary-800 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",children:l===w._id?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"h-3 w-3 animate-spin"}),"Marking..."]}):"Mark as read"})]})]}),e.jsx("p",{className:`text-sm mt-1 ${w.isRead?"text-gray-500":"text-gray-700"}`,children:w.message}),((N=w.data)==null?void 0:N.url)&&e.jsx("a",{href:w.data.url,className:"text-xs text-primary-600 hover:text-primary-800 mt-2 inline-block",children:"View details →"})]})]})},w._id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[e.jsx(D,{className:"h-12 w-12 text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:h==="unread"?"You're all caught up!":"You don't have any notifications yet."})]})}),e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:[S.length," notification",S.length!==1?"s":""]}),e.jsxs("span",{children:[n," unread"]})]})})]})}):null},Wr=()=>{const[r,t]=p.useState(!1),[s,n]=p.useState(!1),[i,a]=p.useState(!1),{getTotalItems:o}=ce(),{user:c,isAuthenticated:h,logout:u,isAdmin:l}=L(),{unreadCount:d}=de(),{isInstallable:x,isInstalled:m,install:b}=$r(),f=Qt(),C=[{path:"/",label:"Home"},{path:"/catalog",label:"Catalog"},{path:"/care-guide",label:"Care Guide"},{path:"/orders",label:"Orders"}];l&&C.push({path:"/admin",label:"Admin"});const S=y=>f.pathname===y,w=async()=>{try{const y=await I.requestPermission();console.log(y?"Notification permission granted":"Notification permission denied")}catch(y){console.error("Error requesting notification permission:",y)}},N=async()=>{try{await b()&&console.log("PWA installed successfully")}catch(y){console.error("PWA install error:",y)}};return e.jsxs("nav",{className:"bg-gradient-primary text-white shadow-lg sticky top-0 z-40",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs(k,{to:"/",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-secondary-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-primary-800 font-bold text-sm sm:text-lg",children:"🍟"})}),e.jsx("span",{className:"text-lg sm:text-xl font-bold",children:"SnacksShop"})]}),e.jsx("div",{className:"hidden md:flex items-center space-x-8",children:C.map(y=>e.jsx(k,{to:y.path,className:`nav-link ${S(y.path)?"active":""}`,children:y.label},y.path))}),e.jsx("div",{className:"hidden md:flex flex-1 max-w-md mx-8",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search snacks, brands, accessories...",className:"w-full px-4 py-2 pl-10 pr-4 rounded-full text-gray-900 focus:outline-none focus:ring-2 focus:ring-secondary-400"}),e.jsx(Te,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[h&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>a(!0),className:"relative p-2 hover:bg-white hover:bg-opacity-10 rounded-full transition-colors group touch-manipulation",children:[e.jsx(D,{className:"h-5 w-5 sm:h-6 sm:w-6"}),d>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-4 h-4 sm:min-w-5 sm:h-5 flex items-center justify-center font-bold animate-pulse shadow-lg px-1",children:d>99?"99+":d})]}),Notification.permission==="denied"&&e.jsx("button",{onClick:w,className:"p-2 hover:bg-white hover:bg-opacity-10 rounded-full transition-colors touch-manipulation",title:"Enable notifications",children:e.jsx(Nt,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]}),e.jsxs("button",{className:"relative p-2 hover:bg-white hover:bg-opacity-10 rounded-full transition-colors touch-manipulation",children:[e.jsx(je,{className:"h-5 w-5 sm:h-6 sm:w-6"}),e.jsx("span",{className:"badge",children:"0"})]}),e.jsxs(k,{to:"/cart",className:"relative p-2 hover:bg-white hover:bg-opacity-10 rounded-full transition-colors touch-manipulation",children:[e.jsx(le,{className:"h-5 w-5 sm:h-6 sm:w-6"}),o()>0&&e.jsx("span",{className:"badge",children:o()})]}),x&&!m&&e.jsx("button",{onClick:N,className:"p-2 hover:bg-white hover:bg-opacity-10 rounded-full transition-colors touch-manipulation",title:"Install App",children:e.jsx(We,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>n(!s),className:"p-2 hover:bg-white hover:bg-opacity-10 rounded-full transition-colors touch-manipulation",children:e.jsx(Ve,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),s&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-50 max-h-80 overflow-y-auto",children:h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 py-2 text-sm text-gray-700 border-b",children:["Welcome, ",c.name]}),e.jsx(k,{to:"/orders",className:"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 touch-manipulation",onClick:()=>n(!1),children:"My Orders"}),e.jsx("button",{onClick:()=>{u(),n(!1)},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 touch-manipulation",children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{to:"/login",className:"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 touch-manipulation",onClick:()=>n(!1),children:"Login"}),e.jsx(k,{to:"/register",className:"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 touch-manipulation",onClick:()=>n(!1),children:"Register"})]})})]}),e.jsx("button",{onClick:()=>t(!r),className:"md:hidden p-2 hover:bg-white hover:bg-opacity-10 rounded-full transition-colors touch-manipulation",children:r?e.jsx(Z,{className:"h-5 w-5 sm:h-6 sm:w-6"}):e.jsx(ns,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]})]}),r&&e.jsxs("div",{className:"md:hidden py-4 border-t border-white border-opacity-20",children:[e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:C.map(y=>e.jsx(k,{to:y.path,className:`block px-4 py-3 rounded-lg transition-colors touch-manipulation ${S(y.path)?"bg-secondary-500 text-primary-800":"hover:bg-white hover:bg-opacity-10"}`,onClick:()=>t(!1),children:y.label},y.path))}),e.jsx("div",{className:"mt-4 px-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search...",className:"w-full px-4 py-2 pl-10 pr-4 rounded-full text-gray-900 focus:outline-none focus:ring-2 focus:ring-secondary-400"}),e.jsx(Te,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})})]})]}),e.jsx(Mr,{isOpen:i,onClose:()=>a(!1)})]})},xt=({children:r,allowedRoles:t=[]})=>{const{isAuthenticated:s,user:n,loading:i}=L();return i?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}):s?t.length>0&&!t.includes(n==null?void 0:n.role)?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):r:e.jsx(Xt,{to:"/login",replace:!0})},ft=()=>{const r=navigator.userAgent;return/Android.*Chrome|Android.*Edg/i.test(r)?"excellent":/iPhone|iPad|iPod/i.test(r)&&/Version\/16\.[4-9]|Version\/1[7-9]/i.test(r)?"good":/iPhone|iPad|iPod/i.test(r)?"limited":/SamsungBrowser/i.test(r)?"good":/Firefox.*Mobile/i.test(r)||/Opera.*Mobile/i.test(r)?"limited":/Chrome|Edg|Firefox|Safari/i.test(r)&&!/Mobile/i.test(r)?"good":"unknown"},Vr=()=>{const[r,t]=p.useState(null),[s,n]=p.useState(!1),[i,a]=p.useState(!1),[o,c]=p.useState("desktop");p.useEffect(()=>{var N;(()=>{const y=navigator.userAgent;/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(y)?/iPad|Android.*Tablet/i.test(y)?c("tablet"):c("mobile"):c("desktop")})(),console.log("PWA Debug Info:"),console.log("- Service Worker:","serviceWorker"in navigator),console.log("- HTTPS:",location.protocol==="https:"),console.log("- Manifest:",(N=document.querySelector('link[rel="manifest"]'))==null?void 0:N.href),console.log("- Display mode:",window.matchMedia("(display-mode: standalone)").matches),console.log("- Standalone:",window.navigator.standalone),console.log("- User Agent:",navigator.userAgent),console.log("- PWA Support:",ft());const f=()=>{if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0){a(!0);return}a(!1)};f();const C=y=>{y.preventDefault(),t(y),n(!0)},S=()=>{a(!0),n(!1),t(null)};window.addEventListener("beforeinstallprompt",C),window.addEventListener("appinstalled",S);const w=setInterval(f,1e3);return()=>{window.removeEventListener("beforeinstallprompt",C),window.removeEventListener("appinstalled",S),clearInterval(w)}},[]);const h=async()=>{if(!r)return;r.prompt();const{outcome:b}=await r.userChoice;console.log(b==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),t(null),n(!1)},u=()=>{n(!1),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};if(i||!s&&!(o==="mobile"&&!r&&!i))return null;const d=()=>{switch(o){case"mobile":return e.jsx(Re,{className:"h-6 w-6"});case"tablet":return e.jsx(as,{className:"h-6 w-6"});default:return e.jsx(is,{className:"h-6 w-6"})}},m=(()=>{const b=ft();switch(o){case"mobile":return b==="limited"?{title:"Limited PWA Support",steps:["Your browser has limited PWA support","Try using Chrome or Samsung Internet for better experience","You can still add to home screen manually"],warning:!0}:{title:"Install SnacksShop App",steps:["Tap the share button in your browser","Select 'Add to Home Screen'","Tap 'Add' to install the app"]};case"tablet":return b==="limited"?{title:"Limited PWA Support",steps:["Your browser has limited PWA support","Try using Chrome for better experience","You can still add to home screen manually"],warning:!0}:{title:"Install SnacksShop App",steps:["Tap the menu button (⋮) in your browser","Select 'Add to Home Screen'","Tap 'Add' to install the app"]};default:return{title:"Install SnacksShop App",steps:["Click the install button below","Or look for the install icon in your browser's address bar","Click 'Install' when prompted"]}}})();return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[d(),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:m.title})]}),e.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Z,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[m.warning&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Limited PWA Support"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Your browser may not support all PWA features"})]})]})}),m.steps.map((b,f)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-sm font-medium ${m.warning?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}`,children:f+1}),e.jsx("p",{className:"text-sm text-gray-700",children:b})]},f))]}),e.jsxs("div",{className:"flex space-x-3",children:[r&&e.jsxs("button",{onClick:h,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx("span",{children:"Install Now"})]}),e.jsx("button",{onClick:u,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Maybe Later"})]}),e.jsx("div",{className:"mt-4 text-xs text-gray-500 text-center",children:"Get the full app experience with offline support and notifications"})]})})},Hr=()=>{const[r,t]=p.useState(!1),[s,n]=p.useState(!1);p.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",()=>{n(!0),t(!0)})},[]);const i=()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(o=>{o&&o.waiting&&(o.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())})},a=()=>{t(!1)};return!r||!s?null:e.jsx("div",{className:"fixed bottom-4 left-4 right-4 bg-blue-600 text-white p-4 rounded-lg shadow-lg z-50 md:left-auto md:right-4 md:max-w-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(os,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Update Available"}),e.jsx("p",{className:"text-sm text-blue-100",children:"New version of SnacksShop is ready"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:i,className:"bg-white text-blue-600 px-3 py-1 rounded text-sm font-medium hover:bg-blue-50 transition-colors flex items-center space-x-1",children:[e.jsx(We,{className:"h-3 w-3"}),e.jsx("span",{children:"Update"})]}),e.jsx("button",{onClick:a,className:"text-blue-200 hover:text-white transition-colors",children:e.jsx(Z,{className:"h-4 w-4"})})]})]})})},zr=()=>{const[r,t]=p.useState(navigator.onLine),[s,n]=p.useState(!1);return p.useEffect(()=>{const i=()=>{t(!0),n(!0),setTimeout(()=>n(!1),3e3)},a=()=>{t(!1),n(!0)};return window.addEventListener("online",i),window.addEventListener("offline",a),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",a)}},[]),s?e.jsx("div",{className:`fixed top-4 right-4 z-50 transition-all duration-300 ${r?"bg-green-500":"bg-red-500"} text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2`,children:r?e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Back Online"})]}):e.jsxs(e.Fragment,{children:[e.jsx(jt,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"You're Offline"})]})}):null},Yr=()=>{const{getCategories:r}=Ge(),[t,s]=p.useState([]),[n,i]=p.useState(!0);p.useEffect(()=>{(async()=>{try{i(!0);const h=await r();s(h||[])}catch(h){console.error("Error loading categories:",h),s([])}finally{i(!1)}})()},[r]);const a=[{id:1,name:"Potato Chips",price:4.99,image:"https://images.unsplash.com/photo-1566478989037-eec170784d0b?w=400&h=300&fit=crop",rating:4.8,reviews:127},{id:2,name:"Corn Chips",price:3.99,image:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",rating:4.9,reviews:203},{id:3,name:"Tortilla Chips",price:5.99,image:"https://images.unsplash.com/photo-1544966503-7cc4ac81b4d4?w=400&h=300&fit=crop",rating:4.6,reviews:89}],o=[{icon:e.jsx(ze,{className:"h-8 w-8"}),title:"Quality Guarantee",description:"All snacks come with a 30-day freshness guarantee"},{icon:e.jsx(Ye,{className:"h-8 w-8"}),title:"Fast Shipping",description:"Professional shipping with freshness guarantee"},{icon:e.jsx(ls,{className:"h-8 w-8"}),title:"Expert Support",description:"24/7 support from our snack experts"}];return e.jsxs("div",{className:"min-h-screen",children:[e.jsx("section",{className:"bg-gradient-primary text-white py-20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsx("h1",{className:"text-5xl lg:text-6xl font-bold leading-tight",children:"Premium Snacks Collection"}),e.jsx("p",{className:"text-xl text-gray-200 leading-relaxed",children:"Discover the world's finest collection of delicious and healthy snacks. Expert curation, fast shipping, and lifetime support."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(k,{to:"/catalog",className:"btn btn-primary inline-flex items-center justify-center",children:["Shop Now",e.jsx(it,{className:"ml-2 h-5 w-5"})]}),e.jsx(k,{to:"/care-guide",className:"btn btn-secondary inline-flex items-center justify-center",children:"Learn More"})]})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:a.map((c,h)=>e.jsxs("div",{className:`card p-4 transform hover:scale-105 transition-all duration-300 ${h===0?"lg:col-span-2":""}`,children:[e.jsx("img",{src:c.image,alt:c.name,className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsx("h3",{className:"font-semibold text-primary-800",children:c.name}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("span",{className:"text-lg font-bold text-primary-600",children:["$",c.price]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(be,{className:"h-4 w-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-sm text-gray-600",children:c.rating})]})]})]},c.id))})})]})})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-primary-800 mb-4",children:"Shop by Category"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Find the perfect snacks for your taste preferences"})]}),n?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}):t.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6",children:t.map(c=>e.jsxs(k,{to:`/catalog?category=${c.name}`,className:"category-card group",children:[e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-primary-200 transition-colors",children:e.jsx("span",{className:"text-2xl",children:"🐍"})}),e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:c.displayName}),e.jsxs("p",{className:"text-sm text-gray-600",children:[c.count," species"]})]},c.name))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600",children:"No categories available yet."})})]})}),e.jsx("section",{className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-primary-800 mb-4",children:"Featured Snakes"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Our most popular and highly-rated snakes"})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:a.map(c=>e.jsxs("div",{className:"product-card",children:[e.jsx("img",{src:c.image,alt:c.name,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-primary-800 mb-2",children:c.name}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-2xl font-bold text-primary-600",children:["$",c.price]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(be,{className:"h-4 w-4 text-yellow-400 fill-current"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[c.rating," (",c.reviews," reviews)"]})]})]}),e.jsx(k,{to:`/product/${c.id}`,className:"btn btn-primary w-full text-center",children:"View Details"})]})]},c.id))}),e.jsx("div",{className:"text-center mt-12",children:e.jsxs(k,{to:"/catalog",className:"btn btn-outline inline-flex items-center",children:["View All Products",e.jsx(it,{className:"ml-2 h-5 w-5"})]})})]})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-primary-800 mb-4",children:"Why Choose SnacksShop?"}),e.jsx("p",{className:"text-xl text-gray-600",children:"We're passionate about providing the best snacks and support"})]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:o.map((c,h)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-6 text-primary-600",children:c.icon}),e.jsx("h3",{className:"text-xl font-semibold text-primary-800 mb-4",children:c.title}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:c.description})]},h))})]})}),e.jsx("section",{className:"py-20 bg-gradient-primary text-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8",children:[e.jsx("h2",{className:"text-4xl font-bold mb-6",children:"Ready to Find Your Perfect Snacks?"}),e.jsx("p",{className:"text-xl text-gray-200 mb-8",children:"Browse our extensive collection and find the perfect snacks for your taste journey."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(k,{to:"/catalog",className:"btn bg-secondary-500 text-primary-800 hover:bg-secondary-600",children:"Browse Catalog"}),e.jsx(k,{to:"/care-guide",className:"btn bg-transparent border-2 border-white text-white hover:bg-white hover:text-primary-800",children:"Care Guide"})]})]})})]})},Gr=({product:r})=>{var o;const{addToCart:t}=ce();console.log("Product data:",r),console.log("Quantity value:",r.quantity,"Type:",typeof r.quantity);const s=typeof r.quantity=="number"?r.quantity:typeof r.quantity=="string"?parseInt(r.quantity)||0:r.quantity||0;console.log("Processed stock (from quantity):",s);const n=c=>{var u;c.preventDefault(),c.stopPropagation();const h={id:r._id||r.id,name:r.name,price:r.price,image:((u=r.images)==null?void 0:u[0])||"/placeholder-snake.svg",category:r.category,species:r.species,difficulty:r.difficulty,stock:s,quantity:s};t(h)},i=c=>{c.preventDefault(),c.stopPropagation(),v.success("Quick view coming soon!")},a=c=>{c.preventDefault(),c.stopPropagation(),v.success("Added to wishlist!")};return e.jsx("div",{className:"bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 group overflow-hidden",children:e.jsxs(k,{to:`/product/${r._id||r.id}`,className:"block",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("img",{src:((o=r.images)==null?void 0:o[0])||"/placeholder-snake.svg",alt:r.name,className:"w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300",onError:c=>{c.target.src="/placeholder-snake.svg"}}),s>0&&s<5&&e.jsxs("div",{className:"absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-semibold",children:["Only ",s," left!"]}),e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:i,className:"p-2 bg-white rounded-full shadow-md hover:bg-gray-50 transition-colors",title:"Quick View",children:e.jsx(K,{className:"h-4 w-4 text-gray-600"})}),e.jsx("button",{onClick:a,className:"p-2 bg-white rounded-full shadow-md hover:bg-gray-50 transition-colors",title:"Add to Wishlist",children:e.jsx(je,{className:"h-4 w-4 text-gray-600"})})]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:r.category}),r.difficulty&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.difficulty==="beginner"?"bg-green-100 text-green-800":r.difficulty==="intermediate"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:r.difficulty})]}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2 group-hover:text-primary-600 transition-colors",children:r.name}),r.species&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r.species}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((c,h)=>e.jsx(be,{className:`h-4 w-4 ${h<(r.rating||4)?"text-yellow-400 fill-current":"text-gray-300"}`},h))}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",r.reviews||Math.floor(Math.random()*50)+10,")"]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["$",r.price]}),r.originalPrice&&r.originalPrice>r.price&&e.jsxs("span",{className:"text-sm text-gray-500 line-through",children:["$",r.originalPrice]})]}),e.jsx("div",{className:"text-sm",children:s>0?e.jsx("span",{className:"text-green-600 font-medium",children:"In Stock"}):e.jsx("span",{className:"text-red-600 font-medium",children:"Out of Stock"})})]}),e.jsxs("button",{onClick:n,disabled:s<=0,className:`w-full flex items-center justify-center gap-2 py-3 px-4 rounded-lg font-semibold transition-all duration-200 ${s>0?"bg-primary-600 hover:bg-primary-700 text-white hover:shadow-lg transform hover:-translate-y-0.5":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[e.jsx(le,{className:"h-5 w-5"}),s>0?"Add to Cart":"Out of Stock"]})]})]})})},Kr=()=>{const{products:r,loading:t,error:s,currentFilter:n,currentCategory:i,setFilter:a,setSearch:o,setCategory:c}=Ge(),[h,u]=Zt(),[l,d]=p.useState(""),[x,m]=p.useState(!1),b=[{value:"all",label:"All Levels"},{value:"beginner",label:"Beginner"},{value:"intermediate",label:"Intermediate"},{value:"expert",label:"Expert"}],f=[{value:"all",label:"All Categories"},{value:"chips",label:"Chips"},{value:"crackers",label:"Crackers"},{value:"nuts",label:"Nuts"},{value:"cookies",label:"Cookies"},{value:"accessories",label:"Accessories"}];p.useEffect(()=>{const N=h.get("category"),y=h.get("difficulty"),E=h.get("search");N&&c(N),y&&a(y),E&&(d(E),o(E))},[h,c,a,o]);const C=N=>{N.preventDefault(),o(l),u({search:l})},S=N=>{a(N),u({difficulty:N})},w=N=>{c(N),u({category:N})};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-primary-800 mb-4",children:"Snacks Catalog"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Discover our premium collection of snacks and accessories"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("form",{onSubmit:C,className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search snacks, brands, accessories...",value:l,onChange:N=>d(N.target.value),className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-primary-500 transition-colors"})]})}),e.jsxs("button",{onClick:()=>m(!x),className:"btn btn-outline flex items-center justify-center lg:hidden",children:[e.jsx(cs,{className:"h-5 w-5 mr-2"}),"Filters"]})]}),(x||window.innerWidth>=1024)&&e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty Level"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(N=>e.jsx("button",{onClick:()=>S(N.value),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${n===N.value?"bg-primary-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:N.label},N.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(N=>e.jsx("button",{onClick:()=>w(N.value),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i===N.value?"bg-primary-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:N.label},N.value))})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-gray-600",children:t?"Loading products...":`Showing ${r.length} products`})}),t&&e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}),s&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx("span",{className:"text-4xl",children:"⚠️"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Error loading products"}),e.jsx("p",{className:"text-gray-600 mb-4",children:s}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",children:"Try Again"})]}),!t&&!s&&r.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map(N=>e.jsx(Gr,{product:N},N._id||N.id))}),!t&&!s&&r.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-4xl",children:"🍟"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No products available"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"We're working on adding more snacks to our collection. Check back soon!"}),e.jsx(k,{to:"/care-guide",className:"btn btn-primary",children:"Learn About Snacks"})]})]})})},Jr=()=>{const{id:r}=bt(),{getProductById:t}=Ge(),{addToCart:s}=ce(),{isAuthenticated:n}=L(),[i,a]=p.useState(0),[o,c]=p.useState(null),[h,u]=p.useState(!0),[l,d]=p.useState(null);if(p.useEffect(()=>{(async()=>{try{u(!0);const S=await t(r);S?c(S):d("Product not found")}catch(S){d(S.message)}finally{u(!1)}})()},[r,t]),h)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading product..."})]})});if(l||!o)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Product Not Found"}),e.jsx("p",{className:"text-gray-600 mb-8",children:l||"The product you're looking for doesn't exist."}),e.jsx(k,{to:"/catalog",className:"btn btn-primary",children:"Browse Products"})]})});const x=()=>{if(!o.inStock){v.error("This product is out of stock");return}s(o)},m=()=>{v.success(`${o.name} added to wishlist!`)},b=C=>{switch(C){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"expert":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},f=[o.image,o.image,o.image];return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs(k,{to:"/catalog",className:"inline-flex items-center text-primary-600 hover:text-primary-800 transition-colors",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Back to Catalog"]})}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-12",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"aspect-square bg-white rounded-2xl overflow-hidden shadow-lg",children:e.jsx("img",{src:f[i],alt:o.name,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:f.map((C,S)=>e.jsx("button",{onClick:()=>a(S),className:`aspect-square rounded-lg overflow-hidden border-2 transition-all ${i===S?"border-primary-500":"border-gray-200 hover:border-gray-300"}`,children:e.jsx("img",{src:C,alt:`${o.name} ${S+1}`,className:"w-full h-full object-cover"})},S))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${b(o.difficulty)}`,children:o.difficulty.charAt(0).toUpperCase()+o.difficulty.slice(1)}),!o.inStock&&e.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800",children:"Out of Stock"})]}),e.jsx("h1",{className:"text-4xl font-bold text-primary-800 mb-2",children:o.name}),o.breed&&e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:o.breed}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("span",{className:"text-3xl font-bold text-primary-600",children:["$",o.price]}),o.rating&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((C,S)=>e.jsx(be,{className:`h-5 w-5 ${S<Math.floor(o.rating)?"text-yellow-400 fill-current":"text-gray-300"}`},S))}),e.jsxs("span",{className:"text-gray-600",children:[o.rating," (",o.reviews," reviews)"]})]})]})]}),e.jsx("div",{className:"prose max-w-none",children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:o.description})}),o.specifications&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-primary-800 mb-4",children:"Specifications"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Object.entries(o.specifications).map(([C,S])=>e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[C,":"]}),e.jsx("span",{className:"text-gray-600",children:S})]},C))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-white rounded-xl shadow-sm",children:[e.jsx(ze,{className:"h-6 w-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Health Guarantee"}),e.jsx("p",{className:"text-sm text-gray-600",children:"30 days"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-white rounded-xl shadow-sm",children:[e.jsx(Ye,{className:"h-6 w-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Safe Shipping"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Overnight"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-white rounded-xl shadow-sm",children:[e.jsx(Oe,{className:"h-6 w-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Expert Support"}),e.jsx("p",{className:"text-sm text-gray-600",children:"24/7"})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:m,className:"btn btn-outline flex items-center justify-center",children:[e.jsx(je,{className:"h-5 w-5 mr-2"}),"Add to Wishlist"]}),e.jsxs("button",{onClick:x,disabled:!o.inStock,className:"btn btn-primary flex items-center justify-center flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(le,{className:"h-5 w-5 mr-2"}),o.inStock?"Add to Cart":"Out of Stock"]})]}),!n&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("p",{className:"text-blue-800 text-sm",children:[e.jsx(k,{to:"/login",className:"font-medium hover:underline",children:"Sign in"})," ","to save items to your wishlist and track orders."]})})]})]}),e.jsxs("div",{className:"mt-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-800 mb-8",children:"You Might Also Like"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:e.jsxs("div",{className:"product-card",children:[e.jsx("img",{src:"https://images.unsplash.com/photo-1551969014-7d2c4cddf0b6?w=400&h=300&fit=crop",alt:"Related Product",className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Corn Snake"}),e.jsx("p",{className:"text-2xl font-bold text-primary-600 mb-4",children:"$199"}),e.jsx(k,{to:"/product/2",className:"btn btn-primary w-full text-center",children:"View Details"})]})]})})]})]})})},Qr=()=>{const r=X(),{items:t,updateQuantity:s,removeFromCart:n,getTotalPrice:i,getTotalItems:a,clearCart:o}=ce(),{isAuthenticated:c}=L(),h=()=>{if(t.length===0){v.error("Your cart is empty!");return}r("/checkout")};return t.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(ds,{className:"h-12 w-12 text-gray-400"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Your cart is empty"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Looks like you haven't added any snacks to your cart yet."}),e.jsx(k,{to:"/catalog",className:"btn btn-primary",children:"Start Shopping"})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(k,{to:"/catalog",className:"flex items-center text-primary-600 hover:text-primary-800 transition-colors",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Continue Shopping"]}),e.jsxs("h1",{className:"text-3xl font-bold text-primary-800",children:["Shopping Cart (",a()," items)"]})]}),e.jsx("button",{onClick:o,className:"text-red-600 hover:text-red-800 transition-colors",children:"Clear Cart"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-4",children:t.map(u=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:u.image||"/placeholder-snake.svg",alt:u.name,className:"w-24 h-24 object-cover rounded-lg",onError:l=>{l.target.src="/placeholder-snake.svg"}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-800 mb-1",children:u.name}),u.breed&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:u.breed}),e.jsxs("p",{className:"text-xl font-bold text-primary-600",children:["$",u.price]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>s(u.id,u.quantity-1),className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 transition-colors",children:e.jsx(hs,{className:"h-4 w-4"})}),e.jsx("span",{className:"w-8 text-center font-medium",children:u.quantity}),e.jsx("button",{onClick:()=>s(u.id,u.quantity+1),className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 transition-colors",children:e.jsx(Ie,{className:"h-4 w-4"})})]}),e.jsx("button",{onClick:()=>n(u.id),className:"text-red-600 hover:text-red-800 transition-colors",children:e.jsx(us,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100 flex justify-end",children:e.jsxs("span",{className:"text-lg font-semibold text-primary-800",children:["$",(u.price*u.quantity).toFixed(2)]})})]},u.id))}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 sticky top-8",children:[e.jsx("h2",{className:"text-xl font-bold text-primary-800 mb-6",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsxs("span",{className:"font-medium",children:["$",i().toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping"}),e.jsx("span",{className:"font-medium",children:"$29.99"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Tax"}),e.jsxs("span",{className:"font-medium",children:["$",(i()*.08).toFixed(2)]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex justify-between text-lg font-bold text-primary-800",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",(i()+29.99+i()*.08).toFixed(2)]})]})})]}),e.jsx("button",{onClick:h,className:"btn btn-primary w-full mb-4",children:"Proceed to Checkout"}),!c&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("p",{className:"text-blue-800 text-sm",children:[e.jsx(k,{to:"/login",className:"font-medium hover:underline",children:"Sign in"})," ","to save your cart and track orders."]})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"✓"})}),e.jsx("span",{children:"Secure checkout with SSL encryption"})]})})]})})]})]})})},Xr=()=>{const r=X(),{items:t,getTotalPrice:s,clearCart:n}=ce(),{isAuthenticated:i,user:a}=L(),[o,c]=p.useState(!1),[h,u]=p.useState(!1),l=p.useRef(!1),[d,x]=p.useState(1),[m,b]=p.useState({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",country:"USA",cardNumber:"",expiryDate:"",cvv:"",cardName:"",shippingMethod:"standard",notes:""});p.useEffect(()=>{if(t.length===0){r("/cart");return}i&&a&&b(A=>({...A,firstName:a.firstName||"",lastName:a.lastName||"",email:a.email||"",phone:a.phone||""}))},[i,t.length,a,r]);const f=A=>{const{name:R,value:j}=A.target;b(q=>({...q,[R]:j}))},C=()=>{if(d===1&&["firstName","lastName","email","phone","address","city","state","zipCode"].filter(j=>!m[j]).length>0){v.error("Please fill in all required fields");return}if(d===2&&["cardNumber","expiryDate","cvv","cardName"].filter(j=>!m[j]).length>0){v.error("Please fill in all payment information");return}x(d+1)},S=()=>{x(d-1)},w=async()=>{const A=Date.now()+Math.random();if(console.log(`🛒 handlePlaceOrder called (ID: ${A}) - preventing duplicate calls`),o||h||l.current){console.log(`🛒 Order already being processed or placed (ID: ${A}), ignoring duplicate call`);return}try{l.current=!0,c(!0),u(!0),console.log(`🛒 Starting order placement (ID: ${A})`);const R={items:t.map(q=>({productId:q.id,quantity:q.quantity})),shippingAddress:{street:m.address,city:m.city,state:m.state,zipCode:m.zipCode,country:m.country,phone:m.phone},billingAddress:{street:m.address,city:m.city,state:m.state,zipCode:m.zipCode,country:m.country},paymentMethod:"online",notes:m.notes};console.log(`🛒 Creating order (ID: ${A}) with data:`,R);const j=await O.createOrder(R);j.success?(v.success("Order placed successfully!"),n(),r(`/orders/${j.data.order._id}`)):v.error(j.message||"Failed to place order")}catch(R){v.error(R.message||"Failed to place order")}finally{c(!1),l.current=!1}},N=s(),y=29.99,E=N*.08,U=N+y+E;return t.length===0?null:e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-primary-800 mb-2",children:"Checkout"}),e.jsx("p",{className:"text-gray-600",children:"Complete your snacks purchase"}),!i&&e.jsx("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ve,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Guest Checkout"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["You're checking out as a guest. You can still place your order, but you won't be able to track it online.",e.jsx("a",{href:"/login",className:"font-medium underline hover:text-blue-800 ml-1",children:"Sign in"})," to save your information and track orders."]})]})]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-center",children:[1,2,3].map(A=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold ${d>=A?"bg-primary-600 text-white":"bg-gray-200 text-gray-600"}`,children:A}),A<3&&e.jsx("div",{className:`w-16 h-1 mx-2 ${d>A?"bg-primary-600":"bg-gray-200"}`})]},A))}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[d===1&&"Shipping Information",d===2&&"Payment Information",d===3&&"Order Review"]})})})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[d===1&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-primary-800 mb-6 flex items-center",children:[e.jsx(ms,{className:"h-5 w-5 mr-2"}),"Shipping Information"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:m.firstName,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:m.lastName,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:m.email,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",name:"phone",value:m.phone,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address *"}),e.jsx("input",{type:"text",name:"address",value:m.address,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),e.jsx("input",{type:"text",name:"city",value:m.city,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State *"}),e.jsx("input",{type:"text",name:"state",value:m.state,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ZIP Code *"}),e.jsx("input",{type:"text",name:"zipCode",value:m.zipCode,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),e.jsxs("select",{name:"country",value:m.country,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"USA",children:"United States"}),e.jsx("option",{value:"CAN",children:"Canada"}),e.jsx("option",{value:"MEX",children:"Mexico"})]})]})]})]}),d===2&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-primary-800 mb-6 flex items-center",children:[e.jsx(ps,{className:"h-5 w-5 mr-2"}),"Payment Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Number *"}),e.jsx("input",{type:"text",name:"cardNumber",value:m.cardNumber,onChange:f,placeholder:"1234 5678 9012 3456",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Date *"}),e.jsx("input",{type:"text",name:"expiryDate",value:m.expiryDate,onChange:f,placeholder:"MM/YY",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CVV *"}),e.jsx("input",{type:"text",name:"cvv",value:m.cvv,onChange:f,placeholder:"123",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cardholder Name *"}),e.jsx("input",{type:"text",name:"cardName",value:m.cardName,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ne,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsx("span",{className:"text-sm text-green-800",children:"Your payment information is encrypted and secure"})]})})]})]}),d===3&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-primary-800 mb-6",children:"Order Review"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Shipping Address"}),e.jsxs("p",{className:"text-gray-600",children:[m.firstName," ",m.lastName,e.jsx("br",{}),m.address,e.jsx("br",{}),m.city,", ",m.state," ",m.zipCode,e.jsx("br",{}),m.country]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Contact Information"}),e.jsxs("p",{className:"text-gray-600",children:[m.email,e.jsx("br",{}),m.phone]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Order Items"}),e.jsx("div",{className:"space-y-2",children:t.map(A=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-600",children:[A.name," x ",A.quantity]}),e.jsxs("span",{className:"font-medium",children:["$",(A.price*A.quantity).toFixed(2)]})]},A.id))})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[d>1&&e.jsx("button",{onClick:S,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Previous"}),e.jsx("div",{className:"ml-auto",children:d<3?e.jsx("button",{onClick:C,className:"btn btn-primary",children:"Next Step"}):e.jsx("button",{onClick:A=>{A.preventDefault(),A.stopPropagation(),w()},disabled:o||h,className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Processing...":"Place Order"})})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 sticky top-8",children:[e.jsx("h2",{className:"text-xl font-bold text-primary-800 mb-6",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsxs("span",{className:"font-medium",children:["$",N.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping"}),e.jsxs("span",{className:"font-medium",children:["$",y.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Tax"}),e.jsxs("span",{className:"font-medium",children:["$",E.toFixed(2)]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex justify-between text-lg font-bold text-primary-800",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",U.toFixed(2)]})]})})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{className:"mb-2",children:"🔒 Secure checkout with SSL encryption"}),e.jsx("p",{className:"mb-2",children:"📦 Free shipping on orders over $100"}),e.jsx("p",{children:"🔄 30-day return policy"})]})]})})]})]})})},gt=()=>{var m,b,f,C,S,w,N,y,E,U,A,R;const{id:r}=bt(),{user:t,isAuthenticated:s}=L(),[n,i]=p.useState([]),[a,o]=p.useState(null),[c,h]=p.useState(!0);p.useEffect(()=>{s&&u()},[s]),p.useEffect(()=>{if(r&&n.length>0){const j=n.find(q=>q._id===r);j&&o(j)}},[r,n]);const u=async()=>{try{h(!0);const j=await O.getOrders();j.success?i(j.data.orders||[]):v.error(j.message||"Failed to load orders")}catch(j){console.error("Error loading orders:",j),v.error("Failed to load orders")}finally{h(!1)}},l=j=>{switch(j){case"pending":return e.jsx(Oe,{className:"h-5 w-5 text-yellow-500"});case"confirmed":return e.jsx(G,{className:"h-5 w-5 text-blue-500"});case"processing":return e.jsx(oe,{className:"h-5 w-5 text-purple-500"});case"shipped":return e.jsx(Ye,{className:"h-5 w-5 text-indigo-500"});case"delivered":return e.jsx(G,{className:"h-5 w-5 text-green-500"});case"cancelled":return e.jsx(xs,{className:"h-5 w-5 text-red-500"});default:return e.jsx(Oe,{className:"h-5 w-5 text-gray-500"})}},d=j=>{const F={pending:{text:"Pending",class:"bg-yellow-100 text-yellow-800"},confirmed:{text:"Confirmed",class:"bg-blue-100 text-blue-800"},processing:{text:"Processing",class:"bg-purple-100 text-purple-800"},shipped:{text:"Shipped",class:"bg-indigo-100 text-indigo-800"},delivered:{text:"Delivered",class:"bg-green-100 text-green-800"},cancelled:{text:"Cancelled",class:"bg-red-100 text-red-800"}}[j]||{text:j,class:"bg-gray-100 text-gray-800"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${F.class}`,children:F.text})},x=j=>new Date(j).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return s?c?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}):a?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsxs(k,{to:"/orders",className:"flex items-center text-primary-600 hover:text-primary-800 transition-colors mr-4",children:[e.jsx(J,{className:"h-5 w-5 mr-2"}),"Back to Orders"]}),e.jsxs("h1",{className:"text-3xl font-bold text-primary-800",children:["Order #",a.orderNumber]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[l(a.status),d(a.status),e.jsx("span",{className:"text-gray-600",children:x(a.createdAt)})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Order Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Shipping Address"}),e.jsxs("div",{className:"text-gray-600",children:[e.jsx("p",{children:(m=a.shippingAddress)==null?void 0:m.street}),e.jsxs("p",{children:[(b=a.shippingAddress)==null?void 0:b.city,", ",(f=a.shippingAddress)==null?void 0:f.state," ",(C=a.shippingAddress)==null?void 0:C.zipCode]}),e.jsx("p",{children:(S=a.shippingAddress)==null?void 0:S.country}),e.jsxs("p",{children:["Phone: ",(w=a.shippingAddress)==null?void 0:w.phone]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2 text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["$",(N=a.subtotal)==null?void 0:N.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Shipping:"}),e.jsxs("span",{children:["$",(y=a.shippingCost)==null?void 0:y.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax:"}),e.jsxs("span",{children:["$",(E=a.tax)==null?void 0:E.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["$",(U=a.totalAmount)==null?void 0:U.toFixed(2)]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Order Items"}),e.jsx("div",{className:"space-y-4",children:(A=a.items)==null?void 0:A.map((j,q)=>{var F,W,te,he,se;return e.jsxs("div",{className:"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg",children:[e.jsx("img",{src:((W=(F=j.product)==null?void 0:F.images)==null?void 0:W[0])||"/placeholder-snake.svg",alt:(te=j.product)==null?void 0:te.name,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:(he=j.product)==null?void 0:he.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",j.quantity]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Price: $",(se=j.price)==null?void 0:se.toFixed(2)]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold text-gray-900",children:["$",(j.price*j.quantity).toFixed(2)]})})]},q)})})]}),a.trackingNumber&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Tracking Information"}),e.jsxs("p",{className:"text-blue-800",children:["Tracking Number: ",a.trackingNumber]}),a.trackingStatus&&e.jsx("p",{className:"text-blue-700 mt-1",children:a.trackingStatus})]}),((R=a.notes)==null?void 0:R.admin)&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Admin Notes"}),e.jsx("p",{className:"text-gray-700",children:a.notes.admin})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-primary-800 mb-2",children:"My Orders"}),e.jsx("p",{className:"text-gray-600",children:"Track and manage your orders"})]}),n.length>0?e.jsx("div",{className:"space-y-6",children:n.map(j=>{var q,F,W;return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[l(j.status),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Order #",j.orderNumber]}),e.jsx("p",{className:"text-gray-600",children:x(j.createdAt)})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-xl font-bold text-primary-600",children:["$",(q=j.totalAmount)==null?void 0:q.toFixed(2)]}),d(j.status)]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[(F=j.items)==null?void 0:F.length," item",((W=j.items)==null?void 0:W.length)!==1?"s":""]}),e.jsxs(k,{to:`/orders/${j._id}`,className:"btn btn-outline flex items-center",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"View Details"]})]})]},j._id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(oe,{className:"h-12 w-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No orders yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You haven't placed any orders yet. Start shopping to see your orders here."}),e.jsx(k,{to:"/catalog",className:"btn btn-primary",children:"Start Shopping"})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please Login"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You need to be logged in to view your orders."}),e.jsx(k,{to:"/login",className:"btn btn-primary",children:"Login"})]})})},Zr=()=>{const[r,t]=p.useState("basics"),s=[{id:"basics",label:"Basics",icon:e.jsx(ke,{className:"h-5 w-5"})},{id:"housing",label:"Housing",icon:e.jsx(ke,{className:"h-5 w-5"})},{id:"feeding",label:"Feeding",icon:e.jsx(gs,{className:"h-5 w-5"})},{id:"handling",label:"Handling",icon:e.jsx(je,{className:"h-5 w-5"})},{id:"health",label:"Health",icon:e.jsx(ze,{className:"h-5 w-5"})},{id:"emergency",label:"Emergency",icon:e.jsx(ys,{className:"h-5 w-5"})}],n=[{level:"beginner",title:"Beginner",icon:e.jsx("span",{className:"text-2xl",children:"🌱"}),description:"Perfect for first-time snake owners. These snakes are hardy, docile, and easy to care for.",color:"bg-green-100 text-green-800 border-green-200"},{level:"intermediate",title:"Intermediate",icon:e.jsx("span",{className:"text-2xl",children:"📈"}),description:"For those with some reptile experience. These snakes require more specific care and handling.",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{level:"expert",title:"Expert",icon:e.jsx("span",{className:"text-2xl",children:"👑"}),description:"Advanced level snakes that require experienced handlers and specialized care.",color:"bg-red-100 text-red-800 border-red-200"}],i=["Always wash your hands before and after handling your snake","Keep a feeding log to track your snake's eating habits","Provide a humid hide during shedding periods","Never feed your snake in its main enclosure to avoid substrate ingestion","Use a snake hook for defensive or nervous snakes","Keep handling sessions short (10-15 minutes) for beginners","Provide enrichment like branches and climbing opportunities","Clean and disinfect the enclosure regularly","Have a backup heat source in case of power outages","Join reptile communities for support and advice"],a=[{name:"Enclosure",icon:e.jsx(ke,{className:"h-6 w-6"}),description:"Glass tank or plastic tub"},{name:"Thermometer",icon:e.jsx(bs,{className:"h-6 w-6"}),description:"Digital thermometer/hygrometer"},{name:"Heat Source",icon:e.jsx("span",{className:"text-xl",children:"🔥"}),description:"Heat mat or ceramic heater"},{name:"Thermostat",icon:e.jsx("span",{className:"text-xl",children:"⚙️"}),description:"Temperature controller"},{name:"Hides",icon:e.jsx("span",{className:"text-xl",children:"🏠"}),description:"Multiple hiding spots"},{name:"Water Bowl",icon:e.jsx(Ns,{className:"h-6 w-6"}),description:"Large enough for soaking"},{name:"Substrate",icon:e.jsx("span",{className:"text-xl",children:"🌿"}),description:"Appropriate bedding material"},{name:"Spray Bottle",icon:e.jsx("span",{className:"text-xl",children:"💧"}),description:"For humidity control"}];return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsxs(k,{to:"/",className:"flex items-center text-primary-600 hover:text-primary-800 transition-colors",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Back to Home"]}),e.jsx("h1",{className:"text-4xl font-bold text-primary-800",children:"Snake Care Guide"})]}),e.jsxs("div",{className:"grid lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 sticky top-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-800 mb-4",children:"Care Topics"}),e.jsx("nav",{className:"space-y-2",children:s.map(o=>e.jsxs("button",{onClick:()=>t(o.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${r===o.id?"bg-primary-100 text-primary-800":"text-gray-600 hover:bg-gray-100"}`,children:[o.icon,o.label]},o.id))})]})}),e.jsxs("div",{className:"lg:col-span-3",children:[r==="basics"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-800 mb-6",children:"Experience Levels"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:n.map(o=>e.jsxs("div",{className:`p-6 rounded-xl border-2 ${o.color}`,children:[e.jsx("div",{className:"text-center mb-4",children:o.icon}),e.jsx("h3",{className:"text-xl font-semibold mb-3 text-center",children:o.title}),e.jsx("p",{className:"text-sm leading-relaxed",children:o.description})]},o.level))})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("h2",{className:"text-3xl font-bold text-primary-800 mb-6 flex items-center gap-3",children:[e.jsx(fs,{className:"h-8 w-8 text-yellow-500"}),"Pro Tips"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:i.map((o,c)=>e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-xl",children:"💡"}),e.jsx("p",{className:"text-gray-700",children:o})]},c))})]})]}),r==="housing"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-800 mb-6",children:"Housing Requirements"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Enclosure Size"}),e.jsx("p",{className:"text-gray-700",children:"Provide an enclosure that's at least as long as your snake and half as wide. For most snakes, a 40-gallon tank is a good starting point."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Substrate"}),e.jsx("p",{className:"text-gray-700",children:"Use appropriate substrate like aspen shavings, cypress mulch, or paper towels. Avoid cedar and pine as they can be harmful."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Hides"}),e.jsx("p",{className:"text-gray-700",children:"Provide at least two hides - one on the warm side and one on the cool side. Snakes need secure hiding spots to feel safe."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Water Bowl"}),e.jsx("p",{className:"text-gray-700",children:"Always provide fresh, clean water in a bowl large enough for your snake to soak in if needed."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Temperature Gradient"}),e.jsx("p",{className:"text-gray-700",children:"Create a temperature gradient with a warm side (80-85°F) and cool side (75-80°F). Use heat mats or ceramic heat emitters."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Humidity"}),e.jsx("p",{className:"text-gray-700",children:"Most snakes need 40-60% humidity. Use a hygrometer to monitor levels and mist the enclosure as needed."})]})]})]})]}),r==="feeding"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-800 mb-6",children:"Feeding Guidelines"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Prey Size"}),e.jsx("p",{className:"text-gray-700",children:"Feed prey that's no wider than the snake's body at its widest point. For most snakes, this means mice or rats."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Feeding Schedule"}),e.jsx("p",{className:"text-gray-700",children:"Young snakes eat weekly, adults every 1-2 weeks. Adjust based on your snake's body condition and activity level."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Frozen vs Live"}),e.jsx("p",{className:"text-gray-700",children:"Frozen/thawed prey is safer and more convenient. Always thaw completely and warm to room temperature before feeding."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Feeding Environment"}),e.jsx("p",{className:"text-gray-700",children:"Feed in a separate container to avoid substrate ingestion and to establish a feeding routine."})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"⚠️ Important Feeding Notes"}),e.jsx("p",{className:"text-yellow-700",children:"Never handle your snake for 24-48 hours after feeding to allow proper digestion. Disturbing a snake during digestion can cause regurgitation."})]})]}),r==="handling"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-800 mb-6",children:"Handling Your Snake"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Start Slowly"}),e.jsx("p",{className:"text-gray-700",children:"Let your snake settle in for a week before handling. Start with short, gentle sessions and gradually increase duration."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Proper Technique"}),e.jsx("p",{className:"text-gray-700",children:"Support the snake's body fully and avoid sudden movements. Let the snake move through your hands naturally."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Reading Body Language"}),e.jsx("p",{className:"text-gray-700",children:"Learn to read your snake's body language. If it's stressed or defensive, give it space and try again later."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Regular Handling"}),e.jsx("p",{className:"text-gray-700",children:"Regular, gentle handling helps snakes become more docile and comfortable with human interaction."})]})]})]})]}),r==="health"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-800 mb-6",children:"Health & Wellness"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Regular Health Checks"}),e.jsx("p",{className:"text-gray-700",children:"Monitor your snake's weight, skin condition, and behavior. Look for signs of illness like lethargy, loss of appetite, or unusual behavior."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Shedding Process"}),e.jsx("p",{className:"text-gray-700",children:"Snakes shed their skin regularly. Provide proper humidity and a rough surface to help with the shedding process."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Veterinary Care"}),e.jsx("p",{className:"text-gray-700",children:"Find a reptile-experienced veterinarian for regular checkups and any health concerns. Annual exams are recommended."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Quarantine"}),e.jsx("p",{className:"text-gray-700",children:"If you have multiple snakes, quarantine new additions for 3-6 months to prevent disease transmission."})]})]})]})]}),r==="emergency"&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-800 mb-6",children:"Emergency Information"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"When to Seek Veterinary Care"}),e.jsx("p",{className:"text-red-700",children:"Contact a reptile veterinarian immediately if you notice: refusal to eat for extended periods, difficulty breathing, unusual discharge, severe lethargy, or any signs of injury."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Emergency Kit"}),e.jsx("p",{className:"text-gray-700",children:"Keep a reptile first aid kit with: digital thermometer, sterile saline, clean towels, and contact information for your veterinarian."})]}),e.jsxs("div",{className:"p-4 bg-primary-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-primary-800 mb-2",children:"Power Outages"}),e.jsx("p",{className:"text-gray-700",children:"Have a backup plan for heating during power outages. Consider battery-powered heat sources or hand warmers wrapped in towels."})]})]})]})]}),e.jsxs("div",{className:"mt-8 bg-white rounded-2xl shadow-lg p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-800 mb-6",children:"Essential Equipment"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:a.map((o,c)=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2 text-primary-600",children:o.icon}),e.jsx("h4",{className:"font-semibold text-primary-800 mb-1",children:o.name}),e.jsx("p",{className:"text-sm text-gray-600",children:o.description})]},c))})]})]})]})]})})},en=()=>{const[r,t]=p.useState({email:"",password:""}),[s,n]=p.useState(!1),[i,a]=p.useState(!1),{login:o,isAdmin:c,isAuthenticated:h}=L(),u=X();p.useEffect(()=>{h&&u(c?"/admin":"/")},[h,c,u]);const l=x=>{t({...r,[x.target.name]:x.target.value})},d=async x=>{x.preventDefault(),a(!0);try{const m=await o(r.email,r.password)}catch(m){console.error("Login error:",m)}finally{a(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs(k,{to:"/",className:"inline-flex items-center text-primary-600 hover:text-primary-800 transition-colors mb-6",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Back to Home"]}),e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl",children:"🐍"})}),e.jsx("h2",{className:"text-3xl font-bold text-primary-800",children:"Welcome Back"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Sign in to your SnakeShop account"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("form",{onSubmit:d,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(vt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:r.email,onChange:l,className:"input pl-10",placeholder:"Enter your email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"password",name:"password",type:s?"text":"password",required:!0,value:r.password,onChange:l,className:"input pl-10 pr-10",placeholder:"Enter your password"}),e.jsx("button",{type:"button",onClick:()=>n(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?e.jsx(Le,{className:"h-5 w-5"}):e.jsx(K,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),e.jsx(k,{to:"#",className:"text-sm text-primary-600 hover:text-primary-800",children:"Forgot password?"})]}),e.jsx("button",{type:"submit",disabled:i,className:"btn btn-primary w-full disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Signing in...":"Sign In"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"btn btn-outline flex items-center justify-center",children:[e.jsx("span",{className:"mr-2",children:"📧"}),"Google"]}),e.jsxs("button",{className:"btn btn-outline flex items-center justify-center",children:[e.jsx("span",{className:"mr-2",children:"📘"}),"Facebook"]})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",e.jsx(k,{to:"/register",className:"text-primary-600 hover:text-primary-800 font-medium",children:"Sign up here"})]})})]})]})})},tn=()=>{const[r,t]=p.useState({name:"",email:"",password:"",confirmPassword:""}),[s,n]=p.useState(!1),[i,a]=p.useState(!1),[o,c]=p.useState(!1),[h,u]=p.useState({}),{register:l}=L(),d=X(),x=f=>{t({...r,[f.target.name]:f.target.value}),h[f.target.name]&&u({...h,[f.target.name]:""})},m=()=>{const f={};return r.name.trim()||(f.name="Name is required"),r.email.trim()?/\S+@\S+\.\S+/.test(r.email)||(f.email="Email is invalid"):f.email="Email is required",r.password?r.password.length<6&&(f.password="Password must be at least 6 characters"):f.password="Password is required",r.password!==r.confirmPassword&&(f.confirmPassword="Passwords do not match"),u(f),Object.keys(f).length===0},b=async f=>{if(f.preventDefault(),!!m()){c(!0);try{await l(r.name,r.email,r.password)&&d("/")}catch(C){console.error("Registration error:",C)}finally{c(!1)}}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs(k,{to:"/",className:"inline-flex items-center text-primary-600 hover:text-primary-800 transition-colors mb-6",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Back to Home"]}),e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl",children:"🐍"})}),e.jsx("h2",{className:"text-3xl font-bold text-primary-800",children:"Join SnakeShop"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Create your account to start shopping"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:r.name,onChange:x,className:`input pl-10 ${h.name?"border-red-500":""}`,placeholder:"Enter your full name"})]}),h.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(vt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:r.email,onChange:x,className:`input pl-10 ${h.email?"border-red-500":""}`,placeholder:"Enter your email"})]}),h.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"password",name:"password",type:s?"text":"password",required:!0,value:r.password,onChange:x,className:`input pl-10 pr-10 ${h.password?"border-red-500":""}`,placeholder:"Create a password"}),e.jsx("button",{type:"button",onClick:()=>n(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?e.jsx(Le,{className:"h-5 w-5"}):e.jsx(K,{className:"h-5 w-5"})})]}),h.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.password})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:i?"text":"password",required:!0,value:r.confirmPassword,onChange:x,className:`input pl-10 pr-10 ${h.confirmPassword?"border-red-500":""}`,placeholder:"Confirm your password"}),e.jsx("button",{type:"button",onClick:()=>a(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?e.jsx(Le,{className:"h-5 w-5"}):e.jsx(K,{className:"h-5 w-5"})})]}),h.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.confirmPassword})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"terms",name:"terms",type:"checkbox",required:!0,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsxs("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-700",children:["I agree to the"," ",e.jsx(k,{to:"#",className:"text-primary-600 hover:text-primary-800",children:"Terms of Service"})," ","and"," ",e.jsx(k,{to:"#",className:"text-primary-600 hover:text-primary-800",children:"Privacy Policy"})]})]}),e.jsx("button",{type:"submit",disabled:o,className:"btn btn-primary w-full disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Creating Account...":"Create Account"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"btn btn-outline flex items-center justify-center",children:[e.jsx("span",{className:"mr-2",children:"📧"}),"Google"]}),e.jsxs("button",{className:"btn btn-outline flex items-center justify-center",children:[e.jsx("span",{className:"mr-2",children:"📘"}),"Facebook"]})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",e.jsx(k,{to:"/login",className:"text-primary-600 hover:text-primary-800 font-medium",children:"Sign in here"})]})})]})]})})},sn=()=>{const[r,t]=p.useState(Notification.permission),[s,n]=p.useState(!1),[i,a]=p.useState(!1),o=async()=>{a(!0);try{const l=await I.requestPermission();t(Notification.permission),l&&console.log("Notification permission granted")}catch(l){console.error("Error requesting permission:",l)}finally{a(!1)}},c=async()=>{a(!0);try{await I.subscribeToPush()&&(n(!0),console.log("Successfully subscribed to push notifications"))}catch(l){console.error("Error subscribing to push:",l)}finally{a(!1)}},h=async()=>{a(!0);try{await I.unsubscribeFromPush()&&(n(!1),console.log("Successfully unsubscribed from push notifications"))}catch(l){console.error("Error unsubscribing from push:",l)}finally{a(!1)}},u=async()=>{try{await I.testNotification()}catch(l){console.error("Error testing notification:",l)}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx(js,{className:"h-6 w-6 text-blue-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Notification Testing"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[r==="granted"?e.jsx(D,{className:"h-5 w-5 text-green-600"}):e.jsx(vs,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Notification Permission"}),e.jsx("p",{className:"text-sm text-gray-600 capitalize",children:r})]})]}),r!=="granted"&&e.jsx("button",{onClick:o,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:i?"Requesting...":"Request Permission"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[s?e.jsx(He,{className:"h-5 w-5 text-green-600"}):e.jsx(jt,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Push Notifications"}),e.jsx("p",{className:"text-sm text-gray-600",children:s?"Subscribed":"Not Subscribed"})]})]}),e.jsx("div",{className:"flex space-x-2",children:s?e.jsx("button",{onClick:h,disabled:i,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors",children:i?"Unsubscribing...":"Unsubscribe"}):e.jsx("button",{onClick:c,disabled:i||r!=="granted",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",children:i?"Subscribing...":"Subscribe"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:u,disabled:r!=="granted",className:"w-full px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(D,{className:"h-5 w-5"}),e.jsx("span",{children:"Test Browser Notification"})]}),e.jsxs("div",{className:"text-sm text-gray-600 text-center",children:[e.jsx("p",{children:"Test notifications to ensure they work properly on your device"}),e.jsx("p",{className:"mt-1",children:"Make sure to allow notifications when prompted"})]})]})]})]})},rn="modulepreload",nn=function(r){return"/"+r},yt={},an=function(t,s,n){if(!s||s.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(s.map(a=>{if(a=nn(a),a in yt)return;yt[a]=!0;const o=a.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(!!n)for(let l=i.length-1;l>=0;l--){const d=i[l];if(d.href===a&&(!o||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${c}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":rn,o||(u.as="script",u.crossOrigin=""),u.href=a,document.head.appendChild(u),o)return new Promise((l,d)=>{u.addEventListener("load",l),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})},on=()=>{const[r,t]=p.useState(!1),[s,n]=p.useState("disconnected"),[i,a]=p.useState("unknown"),[o,c]=p.useState([]),[h,u]=p.useState(!1);L();const{socket:l,isConnected:d}=et();p.useEffect(()=>{const y=navigator.userAgent,E=/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(y);t(E),a(Notification.permission),n(d?"connected":"disconnected")},[d]);const x=(y,E,U)=>{c(A=>[...A,{test:y,status:E,message:U,timestamp:new Date}])},m=async()=>{u(!0);try{console.log("Testing notification permission..."),x("Permission","testing","Requesting notification permission...");const y=await I.requestPermission();a(Notification.permission),y?x("Permission","success","Notification permission granted"):x("Permission","error","Notification permission denied")}catch(y){x("Permission","error",`Permission error: ${y.message}`)}finally{u(!1)}},b=()=>{console.log("Testing socket connection..."),x("Socket","testing","Checking socket connection..."),l?d?x("Socket","success",`Connected (ID: ${l.id})`):x("Socket","error","Socket not connected"):x("Socket","error","Socket instance not available")},f=async()=>{console.log("Testing notification sound..."),x("Sound","testing","Testing notification sound...");try{const{playNotificationSound:y}=await an(()=>Promise.resolve().then(()=>Vs),void 0);y(),x("Sound","success","Notification sound played")}catch(y){x("Sound","error",`Sound error: ${y.message}`)}},C=async()=>{console.log("Testing browser notification..."),x("Browser Notification","testing","Testing browser notification...");try{if(Notification.permission==="granted"){const y=new Notification("Mobile Test",{body:"This is a test notification on mobile",icon:"/icons/icon-192x192.png",badge:"/icons/icon-72x72.png",vibrate:[200,100,200],requireInteraction:!0});y.onclick=()=>{console.log("Notification clicked"),y.close()},x("Browser Notification","success","Browser notification sent")}else x("Browser Notification","error","Notification permission not granted")}catch(y){x("Browser Notification","error",`Browser notification error: ${y.message}`)}},S=async()=>{c([]),u(!0);try{await m(),b(),f(),await C()}finally{u(!1)}},w=y=>{switch(y){case"success":return e.jsx(G,{className:"h-4 w-4 text-green-600"});case"error":return e.jsx(Pe,{className:"h-4 w-4 text-red-600"});case"testing":return e.jsx("div",{className:"h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"});default:return e.jsx("div",{className:"h-4 w-4 bg-gray-400 rounded-full"})}},N=y=>{switch(y){case"success":return"text-green-600";case"error":return"text-red-600";case"testing":return"text-blue-600";default:return"text-gray-600"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(Re,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Mobile Notification Test"})]}),e.jsx("div",{className:"mb-6 space-y-4",children:e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Device Information"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Device:"})," ",r?"Mobile":"Desktop"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"User Agent:"})," ",navigator.userAgent]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Socket Status:"})," ",e.jsx("span",{className:s==="connected"?"text-green-600":"text-red-600",children:s})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Permission:"})," ",e.jsx("span",{className:i==="granted"?"text-green-600":"text-red-600",children:i})]})]})]})}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("button",{onClick:m,disabled:h,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{children:"Test Permission"})]}),e.jsxs("button",{onClick:b,disabled:h,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsx("span",{children:"Test Socket"})]}),e.jsxs("button",{onClick:f,disabled:h,className:"w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{children:"Test Sound"})]}),e.jsxs("button",{onClick:C,disabled:h||i!=="granted",className:"w-full px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{children:"Test Browser Notification"})]}),e.jsxs("button",{onClick:S,disabled:h,className:"w-full px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Re,{className:"h-5 w-5"}),e.jsx("span",{children:h?"Running Tests...":"Run All Tests"})]})]}),o.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Test Results"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:o.map((y,E)=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded",children:[w(y.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-medium ${N(y.status)}`,children:y.test}),e.jsx("p",{className:"text-xs text-gray-600",children:y.message})]}),e.jsx("div",{className:"text-xs text-gray-500",children:y.timestamp.toLocaleTimeString()})]},E))})]})]})},ln=()=>{const{user:r,isAuthenticated:t,isAdmin:s}=L(),{unreadCount:n,loadNotifications:i}=de(),{socket:a,isConnected:o}=et(),[c,h]=p.useState("overview"),[u,l]=p.useState(!1),[d,x]=p.useState([]),[m,b]=p.useState([]),[f,C]=p.useState([]),[S,w]=p.useState({totalOrders:0,totalUsers:0,totalProducts:0,totalRevenue:0,pendingOrders:0,completedOrders:0}),[N,y]=p.useState(!1),[E,U]=p.useState(!1),[A,R]=p.useState(null),[j,q]=p.useState(""),[F,W]=p.useState(""),[te,he]=p.useState(""),[se,Vt]=p.useState(""),tt=async()=>{try{if(console.log("🔔 Testing notification..."),console.log("🔔 Socket connected:",o),console.log("🔔 Socket ID:",a==null?void 0:a.id),"Notification"in window)if(Notification.permission==="granted"){const g=new Notification("🔔 Test Notification",{body:"This is a test notification from SnacksShop Admin",icon:"/logo192.png",tag:"test-notification"});g.onclick=()=>{console.log("🔔 Test notification clicked"),g.close()},setTimeout(()=>g.close(),5e3),v.success("🔔 Test notification sent!")}else await Notification.requestPermission()==="granted"?tt():v.error("Notification permission denied");else v.error("Notifications not supported in this browser")}catch(g){console.error("🔔 Test notification error:",g),v.error("Failed to send test notification")}},Ht=async()=>{try{v.loading("Refreshing notifications...",{id:"refresh"}),await i(),v.success("Notifications refreshed!",{id:"refresh"})}catch(g){console.error("Error refreshing notifications:",g),v.error("Failed to refresh notifications",{id:"refresh"})}};p.useEffect(()=>{t&&!s&&(window.location.href="/")},[t,s]),p.useEffect(()=>{t&&s&&st()},[t,s]);const st=async()=>{try{l(!0);const g=await O.getOrders({limit:10});g.success&&x(g.data.orders||[]);const T=await O.getUsers({limit:10});T.success&&b(T.data.users||[]);const z=await O.getProducts({limit:10});z.success&&C(z.data.products||[]);const Q=g.success?g.data.orders||[]:[],re=T.success?T.data.users||[]:[],Yt=z.success?z.data.products||[]:[];w({totalOrders:Q.length,totalUsers:re.length,totalProducts:Yt.length,totalRevenue:Q.reduce((ne,Gt)=>ne+(Gt.totalAmount||0),0),pendingOrders:Q.filter(ne=>ne.status==="pending").length,completedOrders:Q.filter(ne=>ne.status==="delivered").length})}catch(g){console.error("Error loading dashboard data:",g),v.error("Failed to load dashboard data")}finally{l(!1)}},rt=async(g,T,z="",Q="")=>{try{const re=await O.updateOrderStatus(g,T,z,Q);re.success?(v.success(`Order ${T} successfully!`),st(),U(!1),y(!1)):v.error(re.message||"Failed to update order status")}catch{v.error("Failed to update order status")}},nt=g=>{const z={pending:{text:"Pending",class:"bg-yellow-100 text-yellow-800"},confirmed:{text:"Confirmed",class:"bg-blue-100 text-blue-800"},processing:{text:"Processing",class:"bg-purple-100 text-purple-800"},shipped:{text:"Shipped",class:"bg-indigo-100 text-indigo-800"},delivered:{text:"Delivered",class:"bg-green-100 text-green-800"},cancelled:{text:"Cancelled",class:"bg-red-100 text-red-800"}}[g]||{text:g,class:"bg-gray-100 text-gray-800"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${z.class}`,children:z.text})},zt=[{id:"overview",label:"Overview",icon:e.jsx(Cs,{className:"h-5 w-5"})},{id:"orders",label:"Orders",icon:e.jsx(le,{className:"h-5 w-5"})},{id:"users",label:"Users",icon:e.jsx(at,{className:"h-5 w-5"})},{id:"products",label:"Products",icon:e.jsx(oe,{className:"h-5 w-5"})},{id:"notifications",label:"Notifications",icon:e.jsx(D,{className:"h-5 w-5"})}];return!t||!s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You need admin privileges to access this page."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-primary-800",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage your snacks shop platform"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:Ht,className:"btn btn-outline inline-flex items-center",children:[e.jsx(D,{className:"h-5 w-5 mr-2"}),"Refresh Notifications"]}),e.jsxs("button",{onClick:tt,className:"btn btn-secondary inline-flex items-center",children:[e.jsx(D,{className:"h-5 w-5 mr-2"}),"Test Notification"]}),e.jsxs(k,{to:"/admin/add-product",className:"btn btn-primary inline-flex items-center",children:[e.jsx(Ie,{className:"h-5 w-5 mr-2"}),"Add Product"]}),e.jsxs("button",{className:"relative btn btn-outline hover:bg-gray-50 transition-colors",children:[e.jsx(D,{className:"h-5 w-5 mr-2"}),"Notifications",n>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-5 h-5 flex items-center justify-center font-bold animate-pulse shadow-lg px-1",children:n>99?"99+":n})]})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:zt.map(g=>e.jsxs("button",{onClick:()=>h(g.id),className:`flex items-center py-2 px-1 border-b-2 font-medium text-sm ${c===g.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[g.icon,e.jsx("span",{className:"ml-2",children:g.label})]},g.id))})}),c==="overview"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(le,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.totalOrders})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(at,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.totalUsers})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(oe,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Products"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.totalProducts})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(ws,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",S.totalRevenue.toFixed(2)]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Orders"})}),e.jsx("div",{className:"p-6",children:u?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})}):d.length>0?e.jsx("div",{className:"space-y-4",children:d.slice(0,5).map(g=>{var T;return e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["Order #",g.orderNumber]}),e.jsx("p",{className:"text-sm text-gray-600",children:((T=g.customer)==null?void 0:T.name)||"Unknown Customer"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["$",g.totalAmount]}),nt(g.status)]})]},g._id)})}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No orders found"})})]})]}),c==="orders"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"All Orders"})}),e.jsx("div",{className:"p-6",children:u?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})}):d.length>0?e.jsx("div",{className:"space-y-4",children:d.map(g=>{var T;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["Order #",g.orderNumber]}),e.jsx("p",{className:"text-sm text-gray-600",children:((T=g.customer)==null?void 0:T.name)||"Unknown Customer"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(g.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["$",g.totalAmount]}),nt(g.status)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[g.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{R(g),W("confirmed"),U(!0)},className:"btn btn-sm btn-primary",children:[e.jsx(Ss,{className:"h-4 w-4 mr-1"}),"Confirm"]}),e.jsxs("button",{onClick:()=>{R(g),y(!0)},className:"btn btn-sm btn-outline text-red-600 border-red-600 hover:bg-red-50",children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),g.status==="confirmed"&&e.jsxs("button",{onClick:()=>{R(g),W("processing"),U(!0)},className:"btn btn-sm btn-primary",children:[e.jsx(Nt,{className:"h-4 w-4 mr-1"}),"Process"]}),g.status==="processing"&&e.jsxs("button",{onClick:()=>{R(g),W("shipped"),U(!0)},className:"btn btn-sm btn-primary",children:[e.jsx(oe,{className:"h-4 w-4 mr-1"}),"Ship"]}),e.jsxs(k,{to:`/orders/${g._id}`,className:"btn btn-sm btn-outline",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"View Details"]})]})]},g._id)})}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No orders found"})})]}),c==="users"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"All Users"})}),e.jsx("div",{className:"p-6",children:u?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})}):m.length>0?e.jsx("div",{className:"space-y-4",children:m.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(ks,{className:"h-5 w-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:g.name}),e.jsx("p",{className:"text-sm text-gray-600",children:g.email}),e.jsx("p",{className:"text-sm text-gray-500",children:g.role})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.isActive?"Active":"Inactive"})})]},g._id))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No users found"})})]}),c==="products"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"All Products"}),e.jsxs(k,{to:"/admin/add-product",className:"btn btn-primary",children:[e.jsx(Ie,{className:"h-5 w-5 mr-2"}),"Add Product"]})]}),e.jsx("div",{className:"p-6",children:u?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})}):f.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(g=>{var T;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("img",{src:((T=g.images)==null?void 0:T[0])||"/placeholder-snake.svg",alt:g.name,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:g.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["$",g.price]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Stock: ",g.quantity]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.isActive?"Active":"Inactive"}),e.jsxs(k,{to:`/product/${g._id}`,className:"btn btn-sm btn-outline",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"View"]})]})]},g._id)})}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No products found"})})]}),c==="notifications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(on,{}),e.jsx(sn,{})]}),E&&A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Update Order Status"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Status"}),e.jsxs("select",{value:F,onChange:g=>W(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),F==="shipped"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tracking Number"}),e.jsx("input",{type:"text",value:te,onChange:g=>he(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter tracking number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes"}),e.jsx("textarea",{value:se,onChange:g=>Vt(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"3",placeholder:"Enter admin notes"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>U(!1),className:"btn btn-outline",children:"Cancel"}),e.jsx("button",{onClick:()=>rt(A._id,F,te,se),className:"btn btn-primary",children:"Update Status"})]})]})}),N&&A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Reject Order"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rejection Reason"}),e.jsx("textarea",{value:j,onChange:g=>q(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"3",placeholder:"Enter rejection reason",required:!0})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>y(!1),className:"btn btn-outline",children:"Cancel"}),e.jsx("button",{onClick:()=>rt(A._id,"cancelled","",j),className:"btn btn-outline text-red-600 border-red-600 hover:bg-red-50",children:"Reject Order"})]})]})})]})})},cn=()=>{const r=X(),{isAdmin:t}=L(),[s,n]=p.useState(!1),[i,a]=p.useState({name:"",description:"",price:"",offerPrice:"",quantity:"",category:"",species:"",difficulty:"beginner",images:[]});Jt.useEffect(()=>{t||r("/")},[t,r]);const o=(l,d)=>{a(x=>({...x,[l]:d}))},c=l=>{const x=Array.from(l.target.files).map(m=>URL.createObjectURL(m));a(m=>({...m,images:[...m.images,...x]}))},h=l=>{a(d=>({...d,images:d.images.filter((x,m)=>m!==l)}))},u=async l=>{if(l.preventDefault(),!s){if(!i.name||!i.description||!i.price||!i.quantity){v.error("Please fill in all required fields");return}if(parseFloat(i.price)<=0){v.error("Price must be greater than 0");return}if(parseInt(i.quantity)<0){v.error("Quantity cannot be negative");return}try{n(!0);const d={name:i.name,description:i.description,price:parseFloat(i.price),offerPrice:i.offerPrice?parseFloat(i.offerPrice):void 0,quantity:parseInt(i.quantity),category:i.category,species:i.species,difficulty:i.difficulty,images:i.images,isActive:!0},x=await O.createProduct(d);x.success?(v.success("Product added successfully!"),r("/admin")):v.error(x.message||"Failed to add product")}catch(d){console.error("Error creating product:",d),v.error("Failed to add product")}finally{n(!1)}}};return t?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsxs("button",{onClick:()=>r("/admin"),className:"flex items-center text-primary-600 hover:text-primary-800 transition-colors mr-4",children:[e.jsx(J,{className:"h-5 w-5 mr-2"}),"Back to Admin"]}),e.jsx("h1",{className:"text-3xl font-bold text-primary-800",children:"Add New Product"})]}),e.jsx("p",{className:"text-gray-600",children:"Add a new snack product to your inventory"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8",children:e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name *"}),e.jsx("input",{type:"text",value:i.name,onChange:l=>o("name",l.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter product name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),e.jsxs("select",{value:i.category,onChange:l=>o("category",l.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select category"}),e.jsx("option",{value:"chips",children:"Chips"}),e.jsx("option",{value:"crackers",children:"Crackers"}),e.jsx("option",{value:"nuts",children:"Nuts"}),e.jsx("option",{value:"cookies",children:"Cookies"}),e.jsx("option",{value:"accessories",children:"Accessories"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx("textarea",{value:i.description,onChange:l=>o("description",l.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:"4",placeholder:"Enter product description",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:i.price,onChange:l=>o("price",l.target.value),className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"0.00",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Offer Price"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:i.offerPrice,onChange:l=>o("offerPrice",l.target.value),className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity *"}),e.jsx("input",{type:"number",min:"0",value:i.quantity,onChange:l=>o("quantity",l.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"0",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Species/Brand"}),e.jsx("input",{type:"text",value:i.species,onChange:l=>o("species",l.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter species or brand"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty Level"}),e.jsxs("select",{value:i.difficulty,onChange:l=>o("difficulty",l.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"expert",children:"Expert"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Images"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(As,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Upload product images"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:c,className:"hidden",id:"image-upload"}),e.jsx("label",{htmlFor:"image-upload",className:"btn btn-outline cursor-pointer",children:"Choose Images"})]})}),i.images.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Uploaded Images:"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:i.images.map((l,d)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:l,alt:`Product ${d+1}`,className:"w-full h-24 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>h(d),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:e.jsx(Z,{className:"h-4 w-4"})})]},d))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>r("/admin"),className:"btn btn-outline",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:s,className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Adding Product...":"Add Product"})]})]})})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You need admin privileges to access this page."})]})})},dn=()=>{const{user:r,isAdmin:t,loading:s}=L(),n=X();return p.useEffect(()=>{r&&!s&&n(t?"/admin":"/")},[r,t,s,n]),s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}):null};class hn{constructor(){this.registration=null,this.updateAvailable=!1,this.isOnline=navigator.onLine,this.setupEventListeners()}setupEventListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.onStatusChange("online")}),window.addEventListener("offline",()=>{this.isOnline=!1,this.onStatusChange("offline")}),"serviceWorker"in navigator&&(navigator.serviceWorker.addEventListener("controllerchange",()=>{this.onControllerChange()}),navigator.serviceWorker.addEventListener("message",t=>{this.onServiceWorkerMessage(t)}))}async registerServiceWorker(){if(!("serviceWorker"in navigator))return console.log("Service Worker not supported"),!1;try{return this.registration=await navigator.serviceWorker.register("/sw.js",{scope:"/"}),console.log("Service Worker registered successfully:",this.registration),this.registration.addEventListener("updatefound",()=>{this.onUpdateFound()}),this.registration.waiting&&(this.updateAvailable=!0,this.onUpdateAvailable()),!0}catch(t){return console.error("Service Worker registration failed:",t),!1}}async unregisterServiceWorker(){if(this.registration){const t=await this.registration.unregister();return t&&(console.log("Service Worker unregistered"),this.registration=null),t}return!1}async updateServiceWorker(){this.registration&&this.registration.waiting&&(this.registration.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())}async clearCache(){if("caches"in window){const t=await caches.keys();await Promise.all(t.map(s=>caches.delete(s))),console.log("All caches cleared")}}async getCacheInfo(){if(!("caches"in window))return{totalCaches:0,totalSize:0};const t=await caches.keys();let s=0;for(const n of t){const a=await(await caches.open(n)).keys();s+=a.length}return{totalCaches:t.length,totalSize:s,cacheNames:t}}async requestNotificationPermission(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission==="denied"?(console.log("Notification permission denied"),!1):await Notification.requestPermission()==="granted":(console.log("Notifications not supported"),!1)}async showNotification(t,s={}){if(!this.registration||Notification.permission!=="granted")return!1;const n={body:"New notification from SnakeShop",icon:"/icons/icon-192x192.png",badge:"/icons/icon-72x72.png",vibrate:[100,50,100],data:{dateOfArrival:Date.now(),primaryKey:1},actions:[{action:"explore",title:"View Details",icon:"/icons/icon-96x96.png"},{action:"close",title:"Close",icon:"/icons/icon-96x96.png"}]};try{return await this.registration.showNotification(t,{...n,...s}),!0}catch(i){return console.error("Failed to show notification:",i),!1}}async registerBackgroundSync(t){if(!this.registration||!("sync"in window.ServiceWorkerRegistration.prototype))return console.log("Background sync not supported"),!1;try{return await this.registration.sync.register(t),console.log("Background sync registered:",t),!0}catch(s){return console.error("Background sync registration failed:",s),!1}}async registerPeriodicSync(t,s){if(!this.registration||!("periodicSync"in window.ServiceWorkerRegistration.prototype))return console.log("Periodic background sync not supported"),!1;try{return await this.registration.periodicSync.register(t,{minInterval:s}),console.log("Periodic background sync registered:",t),!0}catch(n){return console.error("Periodic background sync registration failed:",n),!1}}onStatusChange(t){console.log("Network status changed:",t),window.dispatchEvent(new CustomEvent("pwa-status-change",{detail:{status:t,isOnline:this.isOnline}}))}onUpdateFound(){console.log("Service Worker update found"),this.updateAvailable=!0,window.dispatchEvent(new CustomEvent("pwa-update-found"))}onUpdateAvailable(){console.log("Service Worker update available"),window.dispatchEvent(new CustomEvent("pwa-update-available"))}onControllerChange(){console.log("Service Worker controller changed"),window.dispatchEvent(new CustomEvent("pwa-controller-change"))}onServiceWorkerMessage(t){console.log("Service Worker message:",t.data),window.dispatchEvent(new CustomEvent("pwa-message",{detail:t.data}))}isStandalone(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}isInstallable(){return"BeforeInstallPromptEvent"in window}getInstallPrompt(){return new Promise(t=>{const s=n=>{n.preventDefault(),t(n),window.removeEventListener("beforeinstallprompt",s)};window.addEventListener("beforeinstallprompt",s)})}async installApp(){if(!this.isInstallable())return!1;try{const n=await(await(await this.getInstallPrompt()).prompt()).userChoice;return console.log("Install prompt outcome:",n),n.outcome==="accepted"}catch(t){return console.error("Install failed:",t),!1}}getAppInfo(){return{isOnline:this.isOnline,isStandalone:this.isStandalone(),isInstallable:this.isInstallable(),hasServiceWorker:!!this.registration,updateAvailable:this.updateAvailable}}}const un=new hn,mn=()=>(Fr(),p.useEffect(()=>{(async()=>{try{await un.registerServiceWorker(),console.log("PWA initialized successfully")}catch(t){console.error("PWA initialization failed:",t)}})()},[]),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Wr,{}),e.jsx("main",{children:e.jsxs(ts,{children:[e.jsx(B,{path:"/",element:e.jsx(Yr,{})}),e.jsx(B,{path:"/catalog",element:e.jsx(Kr,{})}),e.jsx(B,{path:"/product/:id",element:e.jsx(Jr,{})}),e.jsx(B,{path:"/cart",element:e.jsx(Qr,{})}),e.jsx(B,{path:"/checkout",element:e.jsx(Xr,{})}),e.jsx(B,{path:"/orders",element:e.jsx(gt,{})}),e.jsx(B,{path:"/orders/:id",element:e.jsx(gt,{})}),e.jsx(B,{path:"/care-guide",element:e.jsx(Zr,{})}),e.jsx(B,{path:"/login",element:e.jsx(en,{})}),e.jsx(B,{path:"/register",element:e.jsx(tn,{})}),e.jsx(B,{path:"/dashboard",element:e.jsx(dn,{})}),e.jsx(B,{path:"/admin",element:e.jsx(xt,{allowedRoles:["admin"],children:e.jsx(ln,{})})}),e.jsx(B,{path:"/admin/add-product",element:e.jsx(xt,{allowedRoles:["admin"],children:e.jsx(cn,{})})})]})}),e.jsx(zr,{}),e.jsx(Vr,{}),e.jsx(Hr,{}),e.jsx(_s,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#4a7c59",color:"#fff"}}})]}));function pn(){return e.jsx(es,{children:e.jsx(Fs,{children:e.jsx(Dr,{children:e.jsx(Et,{children:e.jsx(Ms,{children:e.jsx(qs,{children:e.jsx(mn,{})})})})})})})}qe.createRoot(document.getElementById("root")).render(e.jsx(pn,{}));
